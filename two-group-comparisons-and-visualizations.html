<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Two-Group Comparisons and Visualizations | TAME 2.0: Expanding and Improving Online Data Science Training for Environmental Health Research</title>
  <meta name="description" content="This is an example of how the TAME 2.0 website will look, I hope!" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Two-Group Comparisons and Visualizations | TAME 2.0: Expanding and Improving Online Data Science Training for Environmental Health Research" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an example of how the TAME 2.0 website will look, I hope!" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Two-Group Comparisons and Visualizations | TAME 2.0: Expanding and Improving Online Data Science Training for Environmental Health Research" />
  
  <meta name="twitter:description" content="This is an example of how the TAME 2.0 website will look, I hope!" />
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-import-from-pdf-sources.html"/>
<link rel="next" href="multi-group-and-multi-variable-comparisons-and-visualizations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.32/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/Data Training Icon for Top Left Bookdown_v2.png"><br></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors-to-tame-2.0"><i class="fa fa-check"></i>Contributors to TAME 2.0</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#module-development-overview"><i class="fa fa-check"></i>Module Development Overview</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ways-to-use-tame-2.0-and-underlying-site-license"><i class="fa fa-check"></i>Ways to use TAME 2.0 and Underlying Site License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#concluding-remarks"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="part"><span><b>Chapter 1 Introductory <br>Data Science</b></span></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html"><i class="fa fa-check"></i>FAIR Data Management Practices</a>
<ul>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#introduction-to-training-module"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#introduction-to-fair"><i class="fa fa-check"></i>Introduction to FAIR</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#breaking-down-fair-letter-by-letter"><i class="fa fa-check"></i>Breaking Down FAIR, Letter-by-Letter</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#what-does-this-mean-for-you"><i class="fa fa-check"></i>What Does This Mean for You?</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#data-repositories-for-sharing-of-data"><i class="fa fa-check"></i>Data Repositories for Sharing of Data</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#recent-shifts-in-regulatory-policies-for-data-sharing"><i class="fa fa-check"></i>Recent Shifts in Regulatory Policies for Data Sharing</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#additional-training-resources-on-fair"><i class="fa fa-check"></i>Additional Training Resources on FAIR</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html"><i class="fa fa-check"></i>Data Sharing through Online Repositories</a>
<ul>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#an-overview-and-example-with-the-dataverse-repository"><i class="fa fa-check"></i>An Overview and Example with the Dataverse Repository</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#introduction-to-training-module-1"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#data-repositories"><i class="fa fa-check"></i>Data Repositories</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#the-dataverse-project"><i class="fa fa-check"></i>The Dataverse Project</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#what-is-a-dataverse"><i class="fa fa-check"></i>What is a Dataverse?</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#metadata"><i class="fa fa-check"></i>Metadata</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#creating-a-dataverse"><i class="fa fa-check"></i>Creating a Dataverse</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#creating-a-dataset"><i class="fa fa-check"></i>Creating a Dataset</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#concluding-remarks-1"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html"><i class="fa fa-check"></i>File Management using Github</a>
<ul>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#introduction-to-training-module-2"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#creating-an-account"><i class="fa fa-check"></i>Creating an Account</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#creating-a-repository"><i class="fa fa-check"></i>Creating a Repository</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#uploading-code"><i class="fa fa-check"></i>Uploading Code</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#adding-subfolders-in-a-repository"><i class="fa fa-check"></i>Adding Subfolders in a Repository</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#updating-code"><i class="fa fa-check"></i>Updating Code</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#updating-repository-titles-and-structure-to-support-a-manuscript"><i class="fa fa-check"></i>Updating Repository Titles and Structure to Support a Manuscript</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#tracking-code-changes-using-github-branches"><i class="fa fa-check"></i>Tracking Code Changes using Github Branches</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#concluding-remarks-2"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html"><i class="fa fa-check"></i>Data Wrangling in Excel</a>
<ul>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#introduction-to-training-module-3"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#save-a-copy-of-the-soon-to-be-organized-and-cleaned-dataset-as-a-new-file"><i class="fa fa-check"></i>Save a Copy of the Soon-To-Be Organized and Cleaned Dataset as a New File</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#remove-extraneous-white-space"><i class="fa fa-check"></i>Remove Extraneous White Space</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#replace-missing-data-with-na"><i class="fa fa-check"></i>Replace Missing Data with “NA”</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#create-a-metadata-tab"><i class="fa fa-check"></i>Create a Metadata Tab</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#abbreviate-and-capitalize-categorical-data"><i class="fa fa-check"></i>Abbreviate and Capitalize Categorical Data</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#alphabetize-sort-the-data-by-the-categorical-variable-of-interest"><i class="fa fa-check"></i>Alphabetize (Sort) the Data by the Categorical Variable of Interest</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#create-a-new-subject-number-column"><i class="fa fa-check"></i>Create a New Subject Number Column</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#remove-special-symbols-and-dashes"><i class="fa fa-check"></i>Remove Special Symbols and Dashes</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#bold-all-column-names-and-center-all-data"><i class="fa fa-check"></i>Bold all Column Names and Center all Data</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#create-a-subject-identifier-column"><i class="fa fa-check"></i>Create a Subject Identifier Column</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#separate-subject-demographic-data-from-experimental-measurements"><i class="fa fa-check"></i>Separate Subject Demographic Data from Experimental Measurements</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#convert-data-from-wide-to-long-format"><i class="fa fa-check"></i>Convert Data from Wide to Long Format</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#pivoting-data-from-a-wide-to-long-format"><i class="fa fa-check"></i>Pivoting Data from a Wide to Long Format</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#generating-summary-level-statistics-with-pivot-tables"><i class="fa fa-check"></i>Generating Summary-Level Statistics with Pivot Tables</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#excel-vs.-r-which-should-you-use"><i class="fa fa-check"></i>Excel vs. R: Which Should You Use?</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#concluding-remarks-3"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="part"><span><b>Chapter 2 Coding in R</b></span></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html"><i class="fa fa-check"></i>Downloading and Programming in R</a>
<ul>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#introduction-to-training-module-4"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#general-introduction-and-installation-of-r-and-rstudio"><i class="fa fa-check"></i>General Introduction and Installation of R and RStudio</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#introduction-to-r-packages"><i class="fa fa-check"></i>Introduction to R Packages</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#scripting-basics"><i class="fa fa-check"></i>Scripting Basics</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#code-troubleshooting"><i class="fa fa-check"></i>Code Troubleshooting</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#concluding-remarks-4"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html"><i class="fa fa-check"></i>Coding “Best” Practices</a>
<ul>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#introduction-to-training-module-5"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#scripting-file-types"><i class="fa fa-check"></i>Scripting File Types</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#script-headers-and-annotation"><i class="fa fa-check"></i>Script Headers and Annotation</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#coding-style"><i class="fa fa-check"></i>Coding Style</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#script-organization"><i class="fa fa-check"></i>Script Organization</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#concluding-remarks-5"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html"><i class="fa fa-check"></i>Data Manipulation and Reshaping</a>
<ul>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html#introduction-to-training-module-6"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html#data-manipulation-using-base-r"><i class="fa fa-check"></i>Data Manipulation Using Base R</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html#introduction-to-tidyverse"><i class="fa fa-check"></i>Introduction to Tidyverse</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html#concluding-remarks-6"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html"><i class="fa fa-check"></i>Improving Coding Efficiencies</a>
<ul>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#introduction-to-training-module-7"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#loops"><i class="fa fa-check"></i>Loops</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#list-operations"><i class="fa fa-check"></i>List operations</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#concluding-remarks-7"><i class="fa fa-check"></i>Concluding Remarks</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#additional-resources-2"><i class="fa fa-check"></i>Additional Resources</a></li>
</ul></li>
<li class="part"><span><b>Chapter 3 Basics of <br>Data Analysis and Visualizations</b></span></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html"><i class="fa fa-check"></i>Data Visualizations</a>
<ul>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#introduction-to-data-visualizations"><i class="fa fa-check"></i>Introduction to Data Visualizations</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#introduction-to-training-module-8"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#density-plot-visualization"><i class="fa fa-check"></i>Density Plot Visualization</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#boxplot-visualization"><i class="fa fa-check"></i>Boxplot Visualization</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#correlation-visualizations"><i class="fa fa-check"></i>Correlation Visualizations</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#heatmap-visualization"><i class="fa fa-check"></i>Heatmap Visualization</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#concluding-remarks-8"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html"><i class="fa fa-check"></i>Improving Data Visualizations</a>
<ul>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#introduction-to-data-visulization-conventions"><i class="fa fa-check"></i>Introduction to Data Visulization Conventions</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#introduction-to-training-module-9"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#creating-an-improved-boxplot-visualization"><i class="fa fa-check"></i>Creating an Improved Boxplot Visualization</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#creating-an-improved-heatmap-visualization"><i class="fa fa-check"></i>Creating an Improved Heatmap Visualization</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#creating-multi-plot-figures"><i class="fa fa-check"></i>Creating Multi-Plot Figures</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#concluding-remarks-9"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html"><i class="fa fa-check"></i>Normality Tests and Data Transformations</a>
<ul>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#introduction-to-training-module-10"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#what-is-a-normal-distribution"><i class="fa fa-check"></i>What is a Normal Distribution?</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#qualitative-assessment-of-normality"><i class="fa fa-check"></i>Qualitative Assessment of Normality</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#quantitative-normality-assessment"><i class="fa fa-check"></i>Quantitative Normality Assessment</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#data-transformation"><i class="fa fa-check"></i>Data Transformation</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#additional-considerations-regarding-normality"><i class="fa fa-check"></i>Additional Considerations Regarding Normality</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#concluding-remarks-10"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html"><i class="fa fa-check"></i>Intoduction to Statistical Tests</a>
<ul>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#introduction-to-training-module-11"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#assessing-normality-homogeneity-of-variance"><i class="fa fa-check"></i>Assessing Normality &amp; Homogeneity of Variance</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#two-group-visualizations-and-statistical-comparisons-using-the-t-test"><i class="fa fa-check"></i>Two-Group Visualizations and Statistical Comparisons using the T-Test</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#three-group-visualizations-and-statistical-comparisons-using-an-anova"><i class="fa fa-check"></i>Three-Group Visualizations and Statistical Comparisons using an ANOVA</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#regression-modeling-and-visualization-linear-and-logistic-regressions"><i class="fa fa-check"></i>Regression Modeling and Visualization: Linear and Logistic Regressions</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#statistical-evaluations-of-categorical-data-using-the-chi-squared-test-and-fishers-exact-test"><i class="fa fa-check"></i>Statistical Evaluations of Categorical Data using the Chi-Squared Test and Fisher’s Exact Test</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#concluding-remarks-11"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="part"><span><b>Chapter 4 Converting Wet Lab Data into Dry Lab Analyses</b></span></li>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html"><i class="fa fa-check"></i>Overview of Experimental Design and Example Data</a>
<ul>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html#introduction-to-training-module-12"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html#replicates"><i class="fa fa-check"></i>Replicates</a></li>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html#orientation-to-example-data-for-chapter-4"><i class="fa fa-check"></i>Orientation to Example Data for Chapter 4</a></li>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html#concluding-remarks-12"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html"><i class="fa fa-check"></i>Data Import, Processing, and Summary Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#introduction-to-training-module-13"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#data-import"><i class="fa fa-check"></i>Data Import</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#handling-missing-values"><i class="fa fa-check"></i>Handling Missing Values</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#averaging-replicates"><i class="fa fa-check"></i>Averaging Replicates</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#descriptive-statistics"><i class="fa fa-check"></i>Descriptive Statistics</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#normality-assessment-and-data-transformation"><i class="fa fa-check"></i>Normality Assessment and Data Transformation</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#concluding-remarks-13"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html"><i class="fa fa-check"></i>Data Import from PDF Sources</a>
<ul>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html#introduction-to-training-module-14"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html#importing-data-from-many-single-pdfs-with-the-same-formatting"><i class="fa fa-check"></i>Importing Data from Many Single PDFs with the Same Formatting</a></li>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html#importing-data-stored-in-pdf-tables"><i class="fa fa-check"></i>Importing Data Stored in PDF Tables</a></li>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html#concluding-remarks-14"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html"><i class="fa fa-check"></i>Two-Group Comparisons and Visualizations</a>
<ul>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#introduction-to-training-module-15"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#overview-of-two-group-statistical-tests"><i class="fa fa-check"></i>Overview of Two Group Statistical Tests</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#statistical-vs-biological-significance"><i class="fa fa-check"></i>Statistical vs Biological Significance</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#unpaired-test-example"><i class="fa fa-check"></i>Unpaired Test Example</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#paired-test-example"><i class="fa fa-check"></i>Paired Test Example</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#visualizing-results"><i class="fa fa-check"></i>Visualizing Results</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#concluding-remarks-15"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html"><i class="fa fa-check"></i>Multi-Group and Multi-Variable Comparisons and Visualizations</a>
<ul>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#introduction-to-training-module-16"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#overview-of-multi-group-statistical-tests"><i class="fa fa-check"></i>Overview of Multi-Group Statistical Tests</a></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#multi-group-analysis-example"><i class="fa fa-check"></i>Multi-Group Analysis Example</a></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#visualization-of-multi-group-statistical-results"><i class="fa fa-check"></i>Visualization of Multi-Group Statistical Results</a></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#concluding-remarks-16"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="part"><span><b>Chapter 5 Machine Learning &amp; Artificial Intelligence</b></span></li>
<li class="part"><span><b>Chapter 6 Applications in Toxicology &amp; Exposure Science</b></span></li>
<li class="part"><span><b>Chapter 7 Environmental Health Database Mining</b></span></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">TAME 2.0: Expanding and Improving Online Data Science Training for Environmental Health Research</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-group-comparisons-and-visualizations" class="section level1 hasAnchor">
<h1>Two-Group Comparisons and Visualizations<a href="two-group-comparisons-and-visualizations.html#two-group-comparisons-and-visualizations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This training module was developed by Elise Hickman, Alexis Payton, and Julia E. Rager.</p>
<p>All input files (script, data, and figures) can be downloaded from the <a href="https://github.com/UNCSRP/TAME2">UNC-SRP TAME2 GitHub website</a>.</p>
<div id="introduction-to-training-module-15" class="section level2 hasAnchor">
<h2>Introduction to Training Module<a href="two-group-comparisons-and-visualizations.html#introduction-to-training-module-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Two group statistical comparisons, in which we want to know whether the means between two different groups are significantly different, are some of the most common statistical tests in environmental health research and even biomedical research as a field. In this training module, we will demonstrate how to run two group statistical comparisons and how to present publication-quality figures and tables of these results. We will continue to use the same example dataset as used in this chapter’s previous modules, which represents concentrations of inflammatory biomarkers secreted by airway epithelial cells after exposure to different concentrations of acrolein.</p>
<div id="training-modules-environmental-health-questions-8" class="section level3 hasAnchor">
<h3>Training Module’s Environmental Health Questions<a href="two-group-comparisons-and-visualizations.html#training-modules-environmental-health-questions-8" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This training module was specifically developed to answer the following environmental health questions:</p>
<ol style="list-style-type: decimal">
<li>Are there significant differences in inflammatory biomarker concentrations between cells from male and female donors at baseline?</li>
<li>Are there significant differences in inflammatory biomarker concentrations between cells exposed to 0 and 4 ppm acrolein?</li>
</ol>
</div>
<div id="workspace-preparation-and-data-import-4" class="section level3 hasAnchor">
<h3>Workspace Preparation and Data Import<a href="two-group-comparisons-and-visualizations.html#workspace-preparation-and-data-import-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Here, we will import the processed data that we generated at the end of <strong>TAME 2.0 Module 4.2 Data Import, Processing, and Summary Statistics</strong>. These data, along with the associated demographic data, were introduced in <strong>TAME 2.0 Module 4.1 Overview of Experimental Design and Example Data</strong>. These data represent log<sub>2</sub> concentrations of inflammatory biomarkers secreted by airway epithelial cells after exposure to four different concentrations of acrolein (plus filtered air as a control). We will also load packages that will be needed for the analysis, including previously introduced packages such as <em>openxlsx</em>, <em>tidyverse</em>, <em>DT</em>, and <em>ggpubr</em>, and additional packages relevant to statistical analysis and graphing that will be discussed in greater detail below.</p>
<div class="sourceCode" id="cb402"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb402-1"><a href="two-group-comparisons-and-visualizations.html#cb402-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load packages</span></span>
<span id="cb402-2"><a href="two-group-comparisons-and-visualizations.html#cb402-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb402-3"><a href="two-group-comparisons-and-visualizations.html#cb402-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb402-4"><a href="two-group-comparisons-and-visualizations.html#cb402-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DT)</span>
<span id="cb402-5"><a href="two-group-comparisons-and-visualizations.html#cb402-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rstatix)</span>
<span id="cb402-6"><a href="two-group-comparisons-and-visualizations.html#cb402-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span></code></pre></div>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="two-group-comparisons-and-visualizations.html#cb403-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Import data</span></span>
<span id="cb403-2"><a href="two-group-comparisons-and-visualizations.html#cb403-2" aria-hidden="true" tabindex="-1"></a>biomarker_data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;Module4_4_Input/Module4_4_InputData1.xlsx&quot;</span>)</span>
<span id="cb403-3"><a href="two-group-comparisons-and-visualizations.html#cb403-3" aria-hidden="true" tabindex="-1"></a>demographic_data <span class="ot">&lt;-</span> <span class="fu">read.xlsx</span>(<span class="st">&quot;Module4_4_Input/Module4_4_InputData2.xlsx&quot;</span>)</span>
<span id="cb403-4"><a href="two-group-comparisons-and-visualizations.html#cb403-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb403-5"><a href="two-group-comparisons-and-visualizations.html#cb403-5" aria-hidden="true" tabindex="-1"></a><span class="co"># View data</span></span>
<span id="cb403-6"><a href="two-group-comparisons-and-visualizations.html#cb403-6" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(biomarker_data)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-d82970dbeaabdff6f6e3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-d82970dbeaabdff6f6e3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80"],["D10","D10","D10","D10","D10","D11","D11","D11","D11","D11","D12","D12","D12","D12","D12","D13","D13","D13","D13","D13","D14","D14","D14","D14","D14","D15","D15","D15","D15","D15","D16","D16","D16","D16","D16","D1","D1","D1","D1","D1","D2","D2","D2","D2","D2","D3","D3","D3","D3","D3","D4","D4","D4","D4","D4","D5","D5","D5","D5","D5","D6","D6","D6","D6","D6","D7","D7","D7","D7","D7","D8","D8","D8","D8","D8","D9","D9","D9","D9","D9"],["0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4","0","0.6","1","2","4"],[3.71808758396052,3.7235585614721,3.70597790168252,3.76553474636298,3.6724253419715,3.83491342970104,3.93073733756289,3.92884403671257,3.80632405739003,3.81762325751143,3.36036427654347,3.27649666564036,3.57167680997093,3.54101915313356,3.10097764772482,3.35755200461808,3.33628338786443,3.31469652565629,3.50589092972996,3.69041709553247,3.31614574229336,3.43562859405209,3.57773093149008,3.87578006306849,3.83086375675176,3.42894634476948,3.49825086752783,3.57288966842058,3.63807383718072,3.6915341649192,3.38681094647222,3.49825086752783,3.58856473740135,3.66220549965362,3.69376571221778,3.76871365703048,3.77820857639809,3.74953426766926,3.84096670448742,3.50589092972996,3.53480866123175,3.60880924267552,3.58856473740135,3.2585189247113,3.75167794568758,3.58014548442338,3.73876783680019,3.61823865559545,3.58736499093646,3.39643353125099,3.52732060787705,3.50842865253186,3.62175885670973,3.23266075679027,4.13996056954546,3.16671544496642,3.18269229751619,3.13422093976063,3.7279204545632,3.799087306074,2.86195536414487,3.08746284125034,3.64961545906341,3.66220549965362,3.64616265715789,3.04614178164472,3.1811025507538,3.27202318906105,3.54101915313356,3.42088657497553,3.37712374912949,3.57531233068744,3.58976348698498,3.83289001416474,3.8972404255748,3.21878116778407,3.30888505741176,3.51853513898218,3.5765221379205,3.7279204545632],[8.68422263328295,8.773963368433559,8.561326136453919,9.710324307072939,7.55028504908841,10.2222394489088,10.1590009172826,9.94747622373011,9.81610366284939,8.03815081026938,9.27052894238072,9.05077375519723,8.99740532549677,8.27635707925924,7.61889934790406,8.15790268278964,8.089053172156429,7.41515020542639,7.37920505996061,4.10265813136374,7.56094417806009,7.5894638929561,7.9047851297316,7.83857365266832,6.50969584193339,9.254131033541951,9.422148885880191,9.165032591502291,9.09402488708305,8.202809492125009,8.68422263328295,8.773963368433559,8.77360079528254,8.60099074240823,7.71163256182322,10.1099481540673,10.3357141430951,9.686097776967401,10.0151641270811,10.1498741117182,8.88962564051876,9.317005526387209,9.03875441393145,8.60099074240823,4.87479696589866,9.23160520814165,9.677085350559841,9.23208509872283,9.583628142323651,9.560179957764181,8.34837407519116,8.351469324267081,8.77360079528254,9.33695280016051,7.70355756192103,3.9429835981871,4.12018602753186,4.24868662687383,5.4110872267986,5.17871464117544,7.43212427264156,6.85112436288675,7.38076407498511,6.96220195703608,8.36382813184704,8.12861303870471,8.0503384381673,7.86530024272912,7.3639595068907,8.90926307937532,11.4238722598684,11.7288813640812,11.4570986742783,10.878112237463,8.52575569282949,7.01077983875324,7.32804655627074,7.03452387533439,7.27537959625362,4.70099449416827],[15.0940690235359,15.1807289234454,15.1191518828101,16.3458996676138,16.7241460980745,15.0028356680746,15.5465951732949,15.4894995973234,16.169128959283,16.0996069083821,13.9520295507825,14.0492691434224,13.1502883461063,14.8168226706095,16.3560077655342,14.30563571243,14.2750718138596,14.2603087281481,14.3170903457307,16.6038859325635,13.9567554773633,14.1371656727442,14.4431119040824,15.1950634099335,16.3613300730261,14.4305440239947,14.6030328264996,14.6583565484435,15.3569594653045,16.5368999542995,14.3291992954213,14.4239037658366,14.5587322032289,15.1950634099335,16.3717050181953,15.1620702745062,15.5056676741312,15.1429673906615,15.4079647745043,16.9008155214109,14.6079451777076,14.6753941971444,13.1497550568455,14.9206710618732,17.2934204566841,14.5987126147926,14.8967320984425,14.6970451993658,15.0929012215711,17.1264130896721,14.542155252148,14.4584290430224,14.8614654668171,15.9922404459517,15.3426552970282,14.1001424218123,13.9841362654046,14.0738746130993,15.2370937904406,16.3510586187167,13.4034767756747,13.4654490662827,13.7572472746771,15.5483372770406,16.2848127161883,13.5861396108168,13.8384840329337,13.8699889688218,14.4670316946933,17.0361832734254,14.1156143059506,14.4239037658366,14.4497857465895,15.0182445232662,15.1484821432167,14.3291992954213,14.1946037445951,13.1529914376826,14.708543993667,16.3449160294487],[0.189033824390017,-0.3040061868901,0.286881147788162,0.298658315564515,1.0703893278914,2.3305584000308,1.37851162325373,1.30451104180995,0.978195629681652,1.64154602908752,0.526068811667588,0.238786859587116,0.713695814843359,1.50589092972996,0.333423733725192,1.24488705912353,-0.3040061868901,1.56559717585423,1.09761079662642,0.855989697308481,1.06350294230616,0.20163386116965,0.895302621333307,1.1243281350022,1.37295209791183,1.27500704749987,0.632268215499513,1.16992500144231,0.910732661902913,1.16992500144231,0.8155754288625729,0.333423733725192,0.748461233004036,0.903038270112912,1.13750352374994,0.367371065648529,0.137503523749935,0.464668267003444,0.910732661902913,0.454175893185802,1.35614381022528,0.298658315564515,0.632268215499513,0.748461233004036,1.40599235967584,0.31034012061215,0.124328135002202,0.53605290024021,0.495695162624069,0.321928094887362,0.879705766282288,0.298658315564515,1.01435529297707,1.19534759832222,2.03210084316702,0.933572638261024,0.20163386116965,2.68706068833989,1.13750352374994,0.84799690655495,1.86393845042397,1.41142624572647,0.992768430768924,1.0071955014042,0.443606651475615,0.650764559116902,0.8718436485093179,1.19534759832222,0.16349873228288,1.17632277264046,1.01435529297707,0.941106310946431,1.04264433740849,0.8718436485093179,1.57531233068744,2.51349074558812,0.604071323668861,0.411426245726465,0.584962500721156,1.47508488294878],[1.73552217729654,1.55581615506164,1.93734439215023,2.08406426478847,2.83390207666916,3.23572705983806,3.24031432933371,3.15218341905505,3.16510798514454,3.48284828306847,1.63226821549951,1.91073266190291,2.35049724708413,3.24031432933371,1.57046293102604,1.32192809488736,1.20789285164133,1.20789285164133,2.75274859140713,2.59931779369823,1.91456452349394,1.72246602447109,1.96347412397489,2.81352468929781,3.27202318906105,2.08746284125034,2.02502879449152,2.37016428054021,2.63923216324928,2.94485844580754,1.83187724119167,1.91073266190291,2.0496307677246,2.64154602908752,2.93168305705981,1.86393845042397,1.790772037862,1.86393845042397,1.88362081628567,2.88362081628567,1.83187724119167,2.0071955014042,2.02147972741045,2.48542682717024,2.98913900736823,2.52606881166759,1.49569516262407,1.85598969730848,1.50080205305716,2.06695024392463,2.47508488294878,2.31034012061215,2.39231742277876,2.99457972421575,3.73226919950145,2.20476675065461,2.34482849699744,1.96347412397489,2.40053792958373,2.85798099512757,1.790772037862,2.11103131238874,2.39506279951758,3.0232553523003,2.16671544496642,1.56559717585423,1.32192809488736,3.59693514238723,1.73552217729654,2.75702324650746,2.53106949272595,2.48284828306847,2.7158933705476,2.99819550315325,3.47118746038699,1.0703893278914,1.33342373372519,1.97819562968165,2.58496250072116,3.08406426478847],[10.4475275409266,10.4320198468125,10.4523853997561,10.7211590148677,11.2458081856384,9.02901108665907,9.22583403553784,9.412739192116421,9.91233549843777,9.316688823436939,9.428025110276749,9.412146396540679,9.620146497339491,10.9260809830959,7.3039633562453,9.247642742898019,9.32424806586749,10.2153509830024,11.2601080099627,10.8557639471917,10.6537676442859,10.6473145095471,10.8149028512154,11.0078962674403,10.9341110109735,9.933439857942711,10.009954550333,10.2267734234482,10.7809497987497,10.646036617491,9.797969484059131,9.8490610025615,10.2090268302306,10.7211590148677,10.8557639471917,9.696480751820189,9.72723977748481,9.49325503512067,10.0461417816447,11.0193335777127,10.534828110721,10.8215188973143,10.8050102485124,11.7900226112658,11.031563370024,9.35887093968562,9.18935511254853,9.033670771393091,9.36430978186441,11.0217850685075,8.283551423174311,8.22211866974429,8.617467465294199,9.414283550503709,8.973180744513019,9.425320822759881,9.308885057411761,9.61402881967061,10.4624204732526,10.7035402591663,10.7662472988462,10.9813603523445,11.5188793273505,11.3227900730377,9.89590846480624,10.3333342781343,10.3711558797312,10.374854737178,10.7157046495212,11.7319596151152,9.92478281821723,9.8490610025615,10.0477374043091,10.6360535917989,9.40224465525408,9.797969484059131,10.0853263897027,10.4360035526972,11.191225812124,10.9299462991725]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Donor<\/th>\n      <th>Dose<\/th>\n      <th>IL1B<\/th>\n      <th>IL6<\/th>\n      <th>IL8<\/th>\n      <th>IL10<\/th>\n      <th>TNFa<\/th>\n      <th>VEGF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Donor","targets":1},{"name":"Dose","targets":2},{"name":"IL1B","targets":3},{"name":"IL6","targets":4},{"name":"IL8","targets":5},{"name":"IL10","targets":6},{"name":"TNFa","targets":7},{"name":"VEGF","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="two-group-comparisons-and-visualizations.html#cb404-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(demographic_data)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-96471ca1145743e3051c" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-96471ca1145743e3051c">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],["D1","D2","D3","D4","D5","D6","D7","D8","D9","D10","D11","D12","D13","D14","D15","D16"],[22,35,27,60,43,38,26,36,40,44,46,52,58,65,37,25],["M","F","M","F","F","M","M","F","F","M","M","M","M","M","F","F"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Donor<\/th>\n      <th>Age_yr<\/th>\n      <th>Sex<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":2},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Donor","targets":1},{"name":"Age_yr","targets":2},{"name":"Sex","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p><br></p>
</div>
</div>
<div id="overview-of-two-group-statistical-tests" class="section level2 hasAnchor">
<h2>Overview of Two Group Statistical Tests<a href="two-group-comparisons-and-visualizations.html#overview-of-two-group-statistical-tests" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Before applying statistical tests to our data, let’s first review common two-group statistical tests, their underlying assumptions, and variations on these tests.</p>
<div id="common-tests" class="section level3 hasAnchor">
<h3>Common Tests<a href="two-group-comparisons-and-visualizations.html#common-tests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The two most common two-group statistical tests are the…</p>
<ul>
<li>t-test (also known as the student’s t-test) and the</li>
<li>Wilcoxon test (also known as the Wilcox test, Wilcoxon test, or Mann Whitney test)</li>
</ul>
<p>Both of these tests are testing the null hypothesis that the means of the two populations (groups) are the same; the alternative hypothesis is that they are not the same. A significant p-value means that we can reject the null hypothesis that the means of the two groups are the same. Whether or not a p-value meets criteria for significance is experiment-specific, though commonly implemented p-value filters for significance include p&lt;0.05 and p&lt;0.01. P-values can also be called alpha values, and they indicate the probability of a <strong>type I error</strong>, or false positive, where the null hypothesis is rejected despite it actually being true. On the other hand, a <strong>type II error</strong>, or false negative, occurs when the null hypothesis is not rejected when it actually should have been.</p>
</div>
<div id="assumptions" class="section level3 hasAnchor">
<h3>Assumptions<a href="two-group-comparisons-and-visualizations.html#assumptions" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The main difference between these two tests is in the assumption about the underlying distribution of the data. T-tests assume that the data are pulled from a normal distribution, while Wilcoxon tests do not assume that the data are pulled from a normal distribution. Therefore, it is most appropriate to use a t-test when data are, in general, normally distributed and a Wilcoxon test when data are not normally distributed.</p>
<p>Additional assumptions underlying t-tests and Wilcoxon test are:</p>
<ul>
<li>The dependent variable is continuous or ordinal (discrete, ordered values).</li>
<li>The data is collected from a representative, random sample.</li>
</ul>
<p>T-tests also assume that:</p>
<ul>
<li>The standard deviations of the two groups are approximately equal (also called homogeneity of variance).</li>
</ul>
</div>
<div id="when-to-use-a-parametric-vs-non-parametric-test" class="section level3 hasAnchor">
<h3>When to Use a Parametric vs Non-Parametric Test?<a href="two-group-comparisons-and-visualizations.html#when-to-use-a-parametric-vs-non-parametric-test" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Deciding whether to use a parametric or non-parametric test isn’t a one size fits all approach, and the decision should be made holistically for each dataset. Typically, parametric tests should be used when the data are normally distributed, continuous, random sampled, without extreme outliers, and representative of independent samples or participants. A non-parametric test can be used when the sample size (<em>n</em>) is small, outliers are present in the dataset, and/or the data are not normally distributed.</p>
<p>This decision matters more when dealing with smaller sample sizes (<em>n</em>&lt;10) as smaller sample sizes are more prone to being skewed, and parametric tests are more sensitive to outliers. Therefore, when dealing with a smaller <em>n</em>, it might be best to perform a data transformation as discussed in <strong>TAME 2.0 Module 3.3 Normality Testing &amp; Data Transformations</strong> and then perform a parametric test if more parametric assumptions are able to be met, or to use non-parametric tests. For larger sample sizes (<em>n</em>&gt;50), outliers can potentially be removed and the dataset can be retested for assumptions. Lastly, what’s considered “small” or “large” in regards to sample size can be subjective and should be taken into consideration within the context of the experiment.</p>
</div>
<div id="variations" class="section level3 hasAnchor">
<h3>Variations<a href="two-group-comparisons-and-visualizations.html#variations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Unequal Variance:</strong> When the assumption of homogeneity of variance is not met, a Welch’s t-test is generally preferred over a student’s t-test. This can be implemented easily by setting <code>var.equal = FALSE</code> as an argument to the function executing the t-test (e.g., <code>t.test()</code>, <code>t_test()</code>). For more on testing homogeneity of variance in R, see <a href="https://www.datanovia.com/en/lessons/homogeneity-of-variance-test-in-r/">here</a>.</p>
<p><strong>Paired vs Unpaired:</strong> Variations on the t-test and Wilcoxon test are used when the experimental design is paired (also called repeated measures or matching). This occurs when there are different treatments, exposures, or time points collected from the same biological/experimental unit. For example, cells from the same donor or passage number exposed to different concentrations of a chemical represents a paired design. Matched/paired experiments have increased power to detect significant differences because samples can be compared back to their own controls.</p>
<p><strong>One vs Two-Sided:</strong> A one-sided test evaluates the hypothesis that the mean of the treatment group significantly differs in a specific direction from the control. A two-sided test evaluates the hypothesis that the mean of the treatment group significantly differs from the control but does not specify a direction for that change. A two-sided test is the preferred approach and the default in R because, typically, either direction of change is possible and represents an informative finding. However, one-sided tests may be appropriate if an effect can only possibly occur in one direction. This can be implemented by setting <code>alternative = "one.sided"</code> within the statistical testing function.</p>
</div>
<div id="which-test-should-i-choose" class="section level3 hasAnchor">
<h3>Which test should I choose?<a href="two-group-comparisons-and-visualizations.html#which-test-should-i-choose" class="anchor-section" aria-label="Anchor link to header"></a></h3>
We provide the following flowchart to help guide your choice of statistical test to compare two groups:
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-80"></span>
<img src="Module4_4_Input/Module4_4_Image1.png" alt="Created with *BioRender.com*" width="800px" />
<p class="caption">
Figure 11: Created with <em>BioRender.com</em>
</p>
</div>
<p><br></p>
</div>
</div>
<div id="statistical-vs-biological-significance" class="section level2 hasAnchor">
<h2>Statistical vs Biological Significance<a href="two-group-comparisons-and-visualizations.html#statistical-vs-biological-significance" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Another important topic to discuss before proceeding to statistical testing is the true meaning of statistical significance. Statistical significance simply means that it is unlikely that the patterns being observed are due to random chance. However, just because an effect is statistically significant does not mean that it is biologically significant (i.e., has notable biological consequences). Often, there also needs to be a sufficient magnitude of effect (also called effect size) for the effects on a system to be meaningful. Although a p-value &lt; 0.05 is often considered the threshold for significance, this is just a standard threshold set to a generally “acceptable” amount of error (5%). What about a p-value of 0.058 with a very large biological effect? Accounting for effect size is also why filters such as log<sub>2</sub> fold change are often applied alongside p-value filters in -omics based analysis.</p>
<p>In discussions of effect size, the population size is also a consideration - a small percentage increase in a very large population can represent tens of thousands of individuals (or more). Another consideration is that we frequently do not know what magnitude of biological effect should be considered “significant.” These discussions can get complicated very quickly, and here we do not propose to have a solution to these thought experiments; rather, we recommend considering both statistical and biological significance when interpreting data. And, as stated in other sections of TAME, transparent reporting of statistical results will aid the audience in interpreting the data through their preferred perspectives.</p>
<p><br></p>
</div>
<div id="unpaired-test-example" class="section level2 hasAnchor">
<h2>Unpaired Test Example<a href="two-group-comparisons-and-visualizations.html#unpaired-test-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will start by performing a statistical test to determine whether there are significant differences in biomarker concentrations between male and female donors at baseline (0 ppm exposure). Previously we determined that the majority of our data was non-normally distributed (see <strong>TAME 2.0 Module 4.2 Data Import, Processing, and Summary Statistics</strong>), so we’ll skip testing for that assumption in this module. Based on those results, we will use the Wilcoxon test to determine if there are significant differences between groups. The Wilcoxon test does not assume homogeneity of variance, so we do not need to test for that prior to applying the test. This is an unpaired analysis because samples collected from the cells derived from male and female donor cells are different sets of cells (i.e., independent from each other). Thus, the specific statistical test applied will be the Wilcoxon Rank Sum test.</p>
<p>First, we will filter our dataframe to only data representing the control (0 ppm) exposure:</p>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="two-group-comparisons-and-visualizations.html#cb405-1" aria-hidden="true" tabindex="-1"></a>biomarker_data_malevsfemale <span class="ot">&lt;-</span> biomarker_data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Dose <span class="sc">==</span> <span class="st">&quot;0&quot;</span>)</span></code></pre></div>
<p>Next, we need to add the demographic data to our dataframe:</p>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="two-group-comparisons-and-visualizations.html#cb406-1" aria-hidden="true" tabindex="-1"></a>biomarker_data_malevsfemale <span class="ot">&lt;-</span> biomarker_data_malevsfemale <span class="sc">%&gt;%</span> <span class="fu">left_join</span>(demographic_data <span class="sc">%&gt;%</span> <span class="fu">select</span>(Donor, Sex), <span class="at">by =</span> <span class="st">&quot;Donor&quot;</span>) </span></code></pre></div>
<p>Here is what our data look like now:</p>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="two-group-comparisons-and-visualizations.html#cb407-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(biomarker_data_malevsfemale)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-04d636c9f70286e6af6f" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-04d636c9f70286e6af6f">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],["D10","D11","D12","D13","D14","D15","D16","D1","D2","D3","D4","D5","D6","D7","D8","D9"],["0","0","0","0","0","0","0","0","0","0","0","0","0","0","0","0"],[3.71808758396052,3.83491342970104,3.36036427654347,3.35755200461808,3.31614574229336,3.42894634476948,3.38681094647222,3.76871365703048,3.53480866123175,3.58014548442338,3.52732060787705,3.16671544496642,2.86195536414487,3.04614178164472,3.37712374912949,3.21878116778407],[8.68422263328295,10.2222394489088,9.27052894238072,8.15790268278964,7.56094417806009,9.254131033541951,8.68422263328295,10.1099481540673,8.88962564051876,9.23160520814165,8.34837407519116,3.9429835981871,7.43212427264156,8.12861303870471,11.4238722598684,7.01077983875324],[15.0940690235359,15.0028356680746,13.9520295507825,14.30563571243,13.9567554773633,14.4305440239947,14.3291992954213,15.1620702745062,14.6079451777076,14.5987126147926,14.542155252148,14.1001424218123,13.4034767756747,13.5861396108168,14.1156143059506,14.3291992954213],[0.189033824390017,2.3305584000308,0.526068811667588,1.24488705912353,1.06350294230616,1.27500704749987,0.8155754288625729,0.367371065648529,1.35614381022528,0.31034012061215,0.879705766282288,0.933572638261024,1.86393845042397,0.650764559116902,1.01435529297707,2.51349074558812],[1.73552217729654,3.23572705983806,1.63226821549951,1.32192809488736,1.91456452349394,2.08746284125034,1.83187724119167,1.86393845042397,1.83187724119167,2.52606881166759,2.47508488294878,2.20476675065461,1.790772037862,1.56559717585423,2.53106949272595,1.0703893278914],[10.4475275409266,9.02901108665907,9.428025110276749,9.247642742898019,10.6537676442859,9.933439857942711,9.797969484059131,9.696480751820189,10.534828110721,9.35887093968562,8.283551423174311,9.425320822759881,10.7662472988462,10.3333342781343,9.92478281821723,9.797969484059131],["M","M","M","M","M","F","F","M","F","M","F","F","M","M","F","F"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Donor<\/th>\n      <th>Dose<\/th>\n      <th>IL1B<\/th>\n      <th>IL6<\/th>\n      <th>IL8<\/th>\n      <th>IL10<\/th>\n      <th>TNFa<\/th>\n      <th>VEGF<\/th>\n      <th>Sex<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Donor","targets":1},{"name":"Dose","targets":2},{"name":"IL1B","targets":3},{"name":"IL6","targets":4},{"name":"IL8","targets":5},{"name":"IL10","targets":6},{"name":"TNFa","targets":7},{"name":"VEGF","targets":8},{"name":"Sex","targets":9}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>We can demonstrate the basic anatomy of the Wilcoxon test function <code>wilcox.test()</code> by running the function on just one variable.</p>
<div class="sourceCode" id="cb408"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb408-1"><a href="two-group-comparisons-and-visualizations.html#cb408-1" aria-hidden="true" tabindex="-1"></a><span class="fu">wilcox.test</span>(IL1B <span class="sc">~</span> Sex, <span class="at">data =</span> biomarker_data_malevsfemale)</span></code></pre></div>
<pre><code>## 
##  Wilcoxon rank sum exact test
## 
## data:  IL1B by Sex
## W = 29, p-value = 0.8371
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>The p-value of 0.8371 indicates that males and females do not have significantly different concentrations of IL-1<span class="math inline">\(\beta\)</span>.</p>
<p>The <code>wilcox.test()</code> function is part of the pre-loaded package <em>stats</em>. The package <a href="https://rpkgs.datanovia.com/rstatix/"><em>rstatix</em></a> provides identical statistical tests to <em>stats</em> but in a pipe-friendly (tidyverse-friendly) format, and these functions output results as dataframes rather than the text displayed above.</p>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="two-group-comparisons-and-visualizations.html#cb410-1" aria-hidden="true" tabindex="-1"></a>biomarker_data_malevsfemale <span class="sc">%&gt;%</span> <span class="fu">wilcox_test</span>(IL1B <span class="sc">~</span> Sex)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 7
##   .y.   group1 group2    n1    n2 statistic     p
## * &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1 IL1B  F      M          7     9        29 0.837</code></pre>
<p>Here, we can see the exact same results as with the <code>wilcox.test()</code> function. For the rest of this module, we’ll proceed with using the <em>rstatix</em> version of statistical testing functions.</p>
<p>Although it is simple to run the Wilcoxon test with the code above, it’s impractical for a large number of endpoints and doesn’t store the results in an organized way. Instead, we can run the Wilcoxon test over every variable of interest using a <code>for</code> loop. There are also other ways you could approach this, such as a function applied over a list. This <code>for</code> loop runs the Wilcoxon test on each endpoint, stores the results in a dataframe, and then binds together the results dataframes for each variable of interest. Note that you could easily change <code>wilcox_test()</code> to <code>t_test()</code> and add additional arguments to modify the way the statistical test is run.</p>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="two-group-comparisons-and-visualizations.html#cb412-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector with the names of the variables you want to run the test on</span></span>
<span id="cb412-2"><a href="two-group-comparisons-and-visualizations.html#cb412-2" aria-hidden="true" tabindex="-1"></a>endpoints <span class="ot">&lt;-</span> <span class="fu">colnames</span>(biomarker_data_malevsfemale <span class="sc">%&gt;%</span> <span class="fu">select</span>(IL1B<span class="sc">:</span>VEGF)) </span>
<span id="cb412-3"><a href="two-group-comparisons-and-visualizations.html#cb412-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-4"><a href="two-group-comparisons-and-visualizations.html#cb412-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe to store results</span></span>
<span id="cb412-5"><a href="two-group-comparisons-and-visualizations.html#cb412-5" aria-hidden="true" tabindex="-1"></a>sex_wilcoxres <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb412-6"><a href="two-group-comparisons-and-visualizations.html#cb412-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-7"><a href="two-group-comparisons-and-visualizations.html#cb412-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run for loop</span></span>
<span id="cb412-8"><a href="two-group-comparisons-and-visualizations.html#cb412-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(endpoints)) {</span>
<span id="cb412-9"><a href="two-group-comparisons-and-visualizations.html#cb412-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb412-10"><a href="two-group-comparisons-and-visualizations.html#cb412-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign a name to the endpoint variable.</span></span>
<span id="cb412-11"><a href="two-group-comparisons-and-visualizations.html#cb412-11" aria-hidden="true" tabindex="-1"></a>  endpoint <span class="ot">&lt;-</span> endpoints[i]</span>
<span id="cb412-12"><a href="two-group-comparisons-and-visualizations.html#cb412-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb412-13"><a href="two-group-comparisons-and-visualizations.html#cb412-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run wilcox test and store in results dataframe.</span></span>
<span id="cb412-14"><a href="two-group-comparisons-and-visualizations.html#cb412-14" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> biomarker_data_malevsfemale <span class="sc">%&gt;%</span></span>
<span id="cb412-15"><a href="two-group-comparisons-and-visualizations.html#cb412-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">wilcox_test</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(endpoint, <span class="st">&quot;~ Sex&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)))</span>
<span id="cb412-16"><a href="two-group-comparisons-and-visualizations.html#cb412-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb412-17"><a href="two-group-comparisons-and-visualizations.html#cb412-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bind results from this test with other tests in this loop</span></span>
<span id="cb412-18"><a href="two-group-comparisons-and-visualizations.html#cb412-18" aria-hidden="true" tabindex="-1"></a>  sex_wilcoxres <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sex_wilcoxres, res_df)</span>
<span id="cb412-19"><a href="two-group-comparisons-and-visualizations.html#cb412-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb412-20"><a href="two-group-comparisons-and-visualizations.html#cb412-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb412-21"><a href="two-group-comparisons-and-visualizations.html#cb412-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb412-22"><a href="two-group-comparisons-and-visualizations.html#cb412-22" aria-hidden="true" tabindex="-1"></a><span class="co"># View results</span></span>
<span id="cb412-23"><a href="two-group-comparisons-and-visualizations.html#cb412-23" aria-hidden="true" tabindex="-1"></a>sex_wilcoxres</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   .y.   group1 group2    n1    n2 statistic     p
##   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;dbl&gt;
## 1 IL1B  F      M          7     9      29   0.837
## 2 IL6   F      M          7     9      28.5 0.791
## 3 IL8   F      M          7     9      34   0.832
## 4 IL10  F      M          7     9      43   0.252
## 5 TNFa  F      M          7     9      39   0.458
## 6 VEGF  F      M          7     9      30   0.916</code></pre>
<div class="question">
<p><i>With this, we can answer <strong>Environmental Health Question #1</strong>:</i>
Are there significant differences in inflammatory biomarker concentrations between cells from male and female donors at baseline?</p>
</div>
<div class="answer">
<p><strong>Answer</strong>: There are not any significant differences in concentrations of any of our biomarkers between male and female donors at baseline.</p>
</div>
<p><br></p>
<div id="adjusting-for-multiple-hypothesis-testing" class="section level3 hasAnchor">
<h3>Adjusting for Multiple Hypothesis Testing<a href="two-group-comparisons-and-visualizations.html#adjusting-for-multiple-hypothesis-testing" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Above, we compared concentrations between males and females for six different endpoints or variables. Each time we run a comparison (with a p-value threshold of &lt; 0.05), we are accepting that there is a 5% chance that a significant result will actually be due to random chance and that we are rejecting the null hypothesis when it is actually true (type I error).</p>
<p>Since we are testing six different hypotheses simultaneously, what is the probability then of observing at least one significant result due just to chance?</p>
<p><span class="math display">\[\mathbb{P}({\rm At Least One Significant Result}) = 1 - \mathbb{P}({\rm NoSignificantResults}) = 1 - (1 - 0.05)^{6} = 0.26\]</span></p>
<p>Here, we can see that we have a 26% chance of observing at least one significant result, even if all the tests are actually not significant. This chance increases as our number of endpoints increases; therefore, adjusting for multiple hypothesis testing becomes even more important with larger datasets. Many methods exist for adjusting for multiple hypothesis testing, with some of the most popular including Bonferroni, False Discovery Rate (FDR), and Benjamini-Hochberg (BH).</p>
<p>However, opinions about when and how to adjust for multiple hypothesis testing can vary and also depend on the question you are trying to answer. For example, when there are a low number of variables (e.g., &lt; 10), it’s often not necessary to adjust for multiple hypothesis testing, and when there are many variables (e.g., 100s to 1000s), it is necessary, but what about for an intermediate number of comparisons? Whether or not to apply multiple hypothesis test correction also depends on whether each endpoint is of interest on its own or whether the analysis seeks to make general statements about all of the endpoints together and on whether reducing type I or type II error is most important in the analysis.</p>
<p>For this analysis, we will not adjust for multiple hypothesis testing due to our relatively low number of variables. For more on multiple hypothesis testing, check out the following publications:</p>
<ul>
<li>Mohieddin J; Naser AP. “Why, When and How to Adjust Your P Values?”. Cell Journal (Yakhteh), 20, 4, 2018, 604-607. doi: 10.22074/cellj.2019.5992 PUBMID: <a href="https://www.celljournal.org/article_250554.html">30124010</a></li>
<li>Feise, R.J. Do multiple outcome measures require p-value adjustment?. BMC Med Res Methodol 2, 8 (2002). <a href="https://doi.org/10.1186/1471-2288-2-8" class="uri">https://doi.org/10.1186/1471-2288-2-8</a> PUBMID: <a href="https://bmcmedresmethodol.biomedcentral.com/articles/10.1186/1471-2288-2-8#citeas">12069695</a></li>
</ul>
<p><br></p>
</div>
</div>
<div id="paired-test-example" class="section level2 hasAnchor">
<h2>Paired Test Example<a href="two-group-comparisons-and-visualizations.html#paired-test-example" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To demonstrate an example of a paired two-group test, we can also determine whether exposure to 4 ppm acrolein significantly changes biomarker concentrations. This is now a paired design because each donor’s cells were exposed to both 0 and 4 ppm acrolein.</p>
<p>To prepare the data, we will filter the dataframe to only include 0 and 4 ppm:</p>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="two-group-comparisons-and-visualizations.html#cb414-1" aria-hidden="true" tabindex="-1"></a>biomarker_data_0vs4 <span class="ot">&lt;-</span> biomarker_data <span class="sc">%&gt;%</span></span>
<span id="cb414-2"><a href="two-group-comparisons-and-visualizations.html#cb414-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(Dose <span class="sc">==</span> <span class="st">&quot;0&quot;</span> <span class="sc">|</span> Dose <span class="sc">==</span> <span class="st">&quot;4&quot;</span>)</span></code></pre></div>
<p>Let’s view the dataframe. Note how the measurements for each donor are next to each other - this an important element of the default handling of the paired analysis in R. The dataframe should have the donors in the same order for the 0 and 4 ppm data.</p>
<div class="sourceCode" id="cb415"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb415-1"><a href="two-group-comparisons-and-visualizations.html#cb415-1" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(biomarker_data_0vs4)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-a41cf9f24e319e0fcbe5" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-a41cf9f24e319e0fcbe5">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32"],["D10","D10","D11","D11","D12","D12","D13","D13","D14","D14","D15","D15","D16","D16","D1","D1","D2","D2","D3","D3","D4","D4","D5","D5","D6","D6","D7","D7","D8","D8","D9","D9"],["0","4","0","4","0","4","0","4","0","4","0","4","0","4","0","4","0","4","0","4","0","4","0","4","0","4","0","4","0","4","0","4"],[3.71808758396052,3.6724253419715,3.83491342970104,3.81762325751143,3.36036427654347,3.10097764772482,3.35755200461808,3.69041709553247,3.31614574229336,3.83086375675176,3.42894634476948,3.6915341649192,3.38681094647222,3.69376571221778,3.76871365703048,3.50589092972996,3.53480866123175,3.75167794568758,3.58014548442338,3.39643353125099,3.52732060787705,4.13996056954546,3.16671544496642,3.799087306074,2.86195536414487,3.64616265715789,3.04614178164472,3.42088657497553,3.37712374912949,3.8972404255748,3.21878116778407,3.7279204545632],[8.68422263328295,7.55028504908841,10.2222394489088,8.03815081026938,9.27052894238072,7.61889934790406,8.15790268278964,4.10265813136374,7.56094417806009,6.50969584193339,9.254131033541951,8.202809492125009,8.68422263328295,7.71163256182322,10.1099481540673,10.1498741117182,8.88962564051876,4.87479696589866,9.23160520814165,9.560179957764181,8.34837407519116,7.70355756192103,3.9429835981871,5.17871464117544,7.43212427264156,8.36382813184704,8.12861303870471,8.90926307937532,11.4238722598684,8.52575569282949,7.01077983875324,4.70099449416827],[15.0940690235359,16.7241460980745,15.0028356680746,16.0996069083821,13.9520295507825,16.3560077655342,14.30563571243,16.6038859325635,13.9567554773633,16.3613300730261,14.4305440239947,16.5368999542995,14.3291992954213,16.3717050181953,15.1620702745062,16.9008155214109,14.6079451777076,17.2934204566841,14.5987126147926,17.1264130896721,14.542155252148,15.3426552970282,14.1001424218123,16.3510586187167,13.4034767756747,16.2848127161883,13.5861396108168,17.0361832734254,14.1156143059506,15.1484821432167,14.3291992954213,16.3449160294487],[0.189033824390017,1.0703893278914,2.3305584000308,1.64154602908752,0.526068811667588,0.333423733725192,1.24488705912353,0.855989697308481,1.06350294230616,1.37295209791183,1.27500704749987,1.16992500144231,0.8155754288625729,1.13750352374994,0.367371065648529,0.454175893185802,1.35614381022528,1.40599235967584,0.31034012061215,0.321928094887362,0.879705766282288,2.03210084316702,0.933572638261024,0.84799690655495,1.86393845042397,0.443606651475615,0.650764559116902,1.17632277264046,1.01435529297707,1.57531233068744,2.51349074558812,1.47508488294878],[1.73552217729654,2.83390207666916,3.23572705983806,3.48284828306847,1.63226821549951,1.57046293102604,1.32192809488736,2.59931779369823,1.91456452349394,3.27202318906105,2.08746284125034,2.94485844580754,1.83187724119167,2.93168305705981,1.86393845042397,2.88362081628567,1.83187724119167,2.98913900736823,2.52606881166759,2.06695024392463,2.47508488294878,3.73226919950145,2.20476675065461,2.85798099512757,1.790772037862,2.16671544496642,1.56559717585423,2.75702324650746,2.53106949272595,3.47118746038699,1.0703893278914,3.08406426478847],[10.4475275409266,11.2458081856384,9.02901108665907,9.316688823436939,9.428025110276749,7.3039633562453,9.247642742898019,10.8557639471917,10.6537676442859,10.9341110109735,9.933439857942711,10.646036617491,9.797969484059131,10.8557639471917,9.696480751820189,11.0193335777127,10.534828110721,11.031563370024,9.35887093968562,11.0217850685075,8.283551423174311,8.973180744513019,9.425320822759881,10.7035402591663,10.7662472988462,9.89590846480624,10.3333342781343,11.7319596151152,9.92478281821723,9.40224465525408,9.797969484059131,10.9299462991725]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Donor<\/th>\n      <th>Dose<\/th>\n      <th>IL1B<\/th>\n      <th>IL6<\/th>\n      <th>IL8<\/th>\n      <th>IL10<\/th>\n      <th>TNFa<\/th>\n      <th>VEGF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[3,4,5,6,7,8]},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Donor","targets":1},{"name":"Dose","targets":2},{"name":"IL1B","targets":3},{"name":"IL6","targets":4},{"name":"IL8","targets":5},{"name":"IL10","targets":6},{"name":"TNFa","targets":7},{"name":"VEGF","targets":8}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>We can now run the same type of loop that we ran before, changing the independent variable in the formula to <code>~ Dose</code> and adding <code>paired = TRUE</code> to the <code>wilcox_test()</code> function.</p>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="two-group-comparisons-and-visualizations.html#cb416-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a vector with the names of the variables you want to run the test on</span></span>
<span id="cb416-2"><a href="two-group-comparisons-and-visualizations.html#cb416-2" aria-hidden="true" tabindex="-1"></a>endpoints <span class="ot">&lt;-</span> <span class="fu">colnames</span>(biomarker_data_0vs4 <span class="sc">%&gt;%</span> <span class="fu">select</span>(IL1B<span class="sc">:</span>VEGF)) </span>
<span id="cb416-3"><a href="two-group-comparisons-and-visualizations.html#cb416-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-4"><a href="two-group-comparisons-and-visualizations.html#cb416-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create dataframe to store results</span></span>
<span id="cb416-5"><a href="two-group-comparisons-and-visualizations.html#cb416-5" aria-hidden="true" tabindex="-1"></a>dose_wilcoxres <span class="ot">&lt;-</span> <span class="fu">data.frame</span>()</span>
<span id="cb416-6"><a href="two-group-comparisons-and-visualizations.html#cb416-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-7"><a href="two-group-comparisons-and-visualizations.html#cb416-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Run for loop</span></span>
<span id="cb416-8"><a href="two-group-comparisons-and-visualizations.html#cb416-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(endpoints)) {</span>
<span id="cb416-9"><a href="two-group-comparisons-and-visualizations.html#cb416-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb416-10"><a href="two-group-comparisons-and-visualizations.html#cb416-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Assign a name to the endpoint variable.</span></span>
<span id="cb416-11"><a href="two-group-comparisons-and-visualizations.html#cb416-11" aria-hidden="true" tabindex="-1"></a>  endpoint <span class="ot">&lt;-</span> endpoints[i]</span>
<span id="cb416-12"><a href="two-group-comparisons-and-visualizations.html#cb416-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb416-13"><a href="two-group-comparisons-and-visualizations.html#cb416-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Run wilcox test and store in results dataframe.</span></span>
<span id="cb416-14"><a href="two-group-comparisons-and-visualizations.html#cb416-14" aria-hidden="true" tabindex="-1"></a>  res_df <span class="ot">&lt;-</span> biomarker_data_0vs4 <span class="sc">%&gt;%</span></span>
<span id="cb416-15"><a href="two-group-comparisons-and-visualizations.html#cb416-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">wilcox_test</span>(<span class="fu">as.formula</span>(<span class="fu">paste0</span>(endpoint, <span class="st">&quot;~ Dose&quot;</span>, <span class="at">sep =</span> <span class="st">&quot;&quot;</span>)),</span>
<span id="cb416-16"><a href="two-group-comparisons-and-visualizations.html#cb416-16" aria-hidden="true" tabindex="-1"></a>                <span class="at">paired =</span> <span class="cn">TRUE</span>)</span>
<span id="cb416-17"><a href="two-group-comparisons-and-visualizations.html#cb416-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb416-18"><a href="two-group-comparisons-and-visualizations.html#cb416-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Bind results from this test with other tests in this loop</span></span>
<span id="cb416-19"><a href="two-group-comparisons-and-visualizations.html#cb416-19" aria-hidden="true" tabindex="-1"></a>  dose_wilcoxres <span class="ot">&lt;-</span> <span class="fu">rbind</span>(dose_wilcoxres, res_df)</span>
<span id="cb416-20"><a href="two-group-comparisons-and-visualizations.html#cb416-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb416-21"><a href="two-group-comparisons-and-visualizations.html#cb416-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb416-22"><a href="two-group-comparisons-and-visualizations.html#cb416-22" aria-hidden="true" tabindex="-1"></a><span class="co"># View results</span></span>
<span id="cb416-23"><a href="two-group-comparisons-and-visualizations.html#cb416-23" aria-hidden="true" tabindex="-1"></a>dose_wilcoxres</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   .y.   group1 group2    n1    n2 statistic         p
##   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;  &lt;int&gt; &lt;int&gt;     &lt;dbl&gt;     &lt;dbl&gt;
## 1 IL1B  0      4         16    16        18 0.00763  
## 2 IL6   0      4         16    16       114 0.0155   
## 3 IL8   0      4         16    16         0 0.0000305
## 4 IL10  0      4         16    16        65 0.9      
## 5 TNFa  0      4         16    16         5 0.000305 
## 6 VEGF  0      4         16    16        28 0.0386</code></pre>
<p>Although this dataframe contains useful information about our statistical test, such as the groups being compared, the sample size (<em>n</em>) of each group, and the test statistic, what we really want (and what would likely be shared in supplemental material), is a more simplified version of these results in table format and more detailed information (<em>n</em>, specific statistical test, groups being compared) in the table legend. We can clean up the results using the following code to make clearer column names and ensure that the p-values are formatted consistently.</p>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="two-group-comparisons-and-visualizations.html#cb418-1" aria-hidden="true" tabindex="-1"></a>dose_wilcoxres <span class="ot">&lt;-</span> dose_wilcoxres <span class="sc">%&gt;%</span></span>
<span id="cb418-2"><a href="two-group-comparisons-and-visualizations.html#cb418-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(.y., p)) <span class="sc">%&gt;%</span></span>
<span id="cb418-3"><a href="two-group-comparisons-and-visualizations.html#cb418-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">p =</span> <span class="fu">format</span>(p, <span class="at">digits =</span> <span class="dv">3</span>, <span class="at">scientific =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb418-4"><a href="two-group-comparisons-and-visualizations.html#cb418-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="st">&quot;Variable&quot;</span> <span class="ot">=</span> <span class="st">&quot;.y.&quot;</span>, <span class="st">&quot;P-Value&quot;</span> <span class="ot">=</span> <span class="st">&quot;p&quot;</span>)</span>
<span id="cb418-5"><a href="two-group-comparisons-and-visualizations.html#cb418-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb418-6"><a href="two-group-comparisons-and-visualizations.html#cb418-6" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(dose_wilcoxres)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-eb7eb155e7117ce612a4" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-eb7eb155e7117ce612a4">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6"],["IL1B","IL6","IL8","IL10","TNFa","VEGF"],["7.63e-03","1.55e-02","3.05e-05","9.00e-01","3.05e-04","3.86e-02"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Variable<\/th>\n      <th>P-Value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Variable","targets":1},{"name":"P-Value","targets":2}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<div class="question">
<p><i>With this, we can answer <strong>Environmental Health Question #2</strong>:</i></p>
<p>Are there significant differences in inflammatory biomarker concentrations between cells exposed to 0 and 4 ppm acrolein?</p>
</div>
<div class="answer">
<p><strong>Answer</strong>: Yes, there are significant differences in IL-1<span class="math inline">\(\beta\)</span>, IL-6, IL-8, TNF-<span class="math inline">\(\alpha\)</span>, and VEGF concentrations between cells exposed to 0 and 4 ppm acrolein.</p>
</div>
<p><br></p>
</div>
<div id="visualizing-results" class="section level2 hasAnchor">
<h2>Visualizing Results<a href="two-group-comparisons-and-visualizations.html#visualizing-results" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now, let’s visualize our results using <em>ggplot2</em>. For an introduction to <em>ggplot2</em> visualizations, see <strong>TAME 2.0 Modules 3.1 Data Visualizations</strong> and <strong>3.2 Improving Data Visualizations</strong>, as well as the extensive online documentation available for <em>ggplot2</em>.</p>
<div id="single-plots" class="section level3 hasAnchor">
<h3>Single Plots<a href="two-group-comparisons-and-visualizations.html#single-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will start by making a very basic box and whisker plot of the IL-1<span class="math inline">\(\beta\)</span> data with individual data points overlaid. It is best practice to show all data points, allowing the reader to view the whole spread of the data, which can be obscured by plots such as bar plots with mean and standard error.</p>
<div class="sourceCode" id="cb419"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb419-1"><a href="two-group-comparisons-and-visualizations.html#cb419-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Setting theme for plot</span></span>
<span id="cb419-2"><a href="two-group-comparisons-and-visualizations.html#cb419-2" aria-hidden="true" tabindex="-1"></a><span class="fu">theme_set</span>(<span class="fu">theme_bw</span>())</span>
<span id="cb419-3"><a href="two-group-comparisons-and-visualizations.html#cb419-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb419-4"><a href="two-group-comparisons-and-visualizations.html#cb419-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Making plot</span></span>
<span id="cb419-5"><a href="two-group-comparisons-and-visualizations.html#cb419-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(biomarker_data_0vs4, <span class="fu">aes</span>(<span class="at">x =</span> Dose, <span class="at">y =</span> IL1B)) <span class="sc">+</span></span>
<span id="cb419-6"><a href="two-group-comparisons-and-visualizations.html#cb419-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb419-7"><a href="two-group-comparisons-and-visualizations.html#cb419-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>))</span></code></pre></div>
<p><img src="04-Chapter4_files/figure-html/unnamed-chunk-91-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We could add statistical markings to denote significance to this graph manually in PowerPoint or Adobe Illustrator, but there are actually R packages that act as extensions to <em>ggplot2</em> and will do this for you! Two of our favorites are <a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/76-add-p-values-and-significance-levels-to-ggplots/"><em>ggpubr</em></a> and <a href="https://cran.r-project.org/web/packages/ggsignif/vignettes/intro.html"><em>ggsignif</em></a>. Here is an example using <em>ggpubr</em>:</p>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="two-group-comparisons-and-visualizations.html#cb420-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(biomarker_data_0vs4, <span class="fu">aes</span>(<span class="at">x =</span> Dose, <span class="at">y =</span> IL1B)) <span class="sc">+</span></span>
<span id="cb420-2"><a href="two-group-comparisons-and-visualizations.html#cb420-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb420-3"><a href="two-group-comparisons-and-visualizations.html#cb420-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>)) <span class="sc">+</span></span>
<span id="cb420-4"><a href="two-group-comparisons-and-visualizations.html#cb420-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding a p value from a paired Wilcoxon test</span></span>
<span id="cb420-5"><a href="two-group-comparisons-and-visualizations.html#cb420-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p><img src="04-Chapter4_files/figure-html/unnamed-chunk-92-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>We can further clean up our figure by modifying elements of the plot’s theme, including the font sizes, axis range, colors, and the way that the statistical results are presented. Perfecting figures can be time consuming but ultimately worth it, because clear figures aid greatly in presenting a coherent story that is understandable to readers/listeners.</p>
<div class="sourceCode" id="cb421"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb421-1"><a href="two-group-comparisons-and-visualizations.html#cb421-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(biomarker_data_0vs4, <span class="fu">aes</span>(<span class="at">x =</span> Dose, <span class="at">y =</span> IL1B)) <span class="sc">+</span></span>
<span id="cb421-2"><a href="two-group-comparisons-and-visualizations.html#cb421-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># outlier.shape = NA removes outliers</span></span>
<span id="cb421-3"><a href="two-group-comparisons-and-visualizations.html#cb421-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Dose), <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb421-4"><a href="two-group-comparisons-and-visualizations.html#cb421-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Changing box plot colors</span></span>
<span id="cb421-5"><a href="two-group-comparisons-and-visualizations.html#cb421-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#BFBFBF&quot;</span>, <span class="st">&quot;#EE2B2B&quot;</span>)) <span class="sc">+</span></span>
<span id="cb421-6"><a href="two-group-comparisons-and-visualizations.html#cb421-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>)) <span class="sc">+</span></span>
<span id="cb421-7"><a href="two-group-comparisons-and-visualizations.html#cb421-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding a p value from a paired Wilcoxon test</span></span>
<span id="cb421-8"><a href="two-group-comparisons-and-visualizations.html#cb421-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb421-9"><a href="two-group-comparisons-and-visualizations.html#cb421-9" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># Changing the value to asterisks and moving to the middle of the plot</span></span>
<span id="cb421-10"><a href="two-group-comparisons-and-visualizations.html#cb421-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="st">&quot;p.signif&quot;</span>, <span class="at">label.x =</span> <span class="fl">1.5</span>, <span class="at">label.y =</span> <span class="fl">4.5</span>, <span class="at">size =</span> <span class="dv">12</span>) <span class="sc">+</span></span>
<span id="cb421-11"><a href="two-group-comparisons-and-visualizations.html#cb421-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">2.5</span>, <span class="dv">5</span>) <span class="sc">+</span></span>
<span id="cb421-12"><a href="two-group-comparisons-and-visualizations.html#cb421-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Changing y axis label </span></span>
<span id="cb421-13"><a href="two-group-comparisons-and-visualizations.html#cb421-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">&quot;Log2(IL-1\u03B2  (pg/mL))&quot;</span>) <span class="sc">+</span></span>
<span id="cb421-14"><a href="two-group-comparisons-and-visualizations.html#cb421-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Removing legend</span></span>
<span id="cb421-15"><a href="two-group-comparisons-and-visualizations.html#cb421-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb421-16"><a href="two-group-comparisons-and-visualizations.html#cb421-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">15</span>),</span>
<span id="cb421-17"><a href="two-group-comparisons-and-visualizations.html#cb421-17" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.75</span>),</span>
<span id="cb421-18"><a href="two-group-comparisons-and-visualizations.html#cb421-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">2</span>),</span>
<span id="cb421-19"><a href="two-group-comparisons-and-visualizations.html#cb421-19" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>))</span></code></pre></div>
<p><img src="04-Chapter4_files/figure-html/unnamed-chunk-93-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
<div id="multiple-plots" class="section level3 hasAnchor">
<h3>Multiple plots<a href="two-group-comparisons-and-visualizations.html#multiple-plots" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Making one plot was relatively straightforward, but to graph all of our endpoints, we would either need to repeat that code chunk for each individual biomarker or write a function to create similar plots given a specific biomarker as input. Then, we would need to stitch together the individual plots in external software or using a package such as <a href="https://patchwork.data-imaginist.com/"><em>patchwork</em></a> (which is a great package if you need to combine individual figures from different sources or different size ratios!).</p>
<p>While these are workable solutions and would get us to the same place, <em>ggplot2</em> actually contains a function - <code>facet_wrap()</code> - that can be used to graph multiple endpoints from the same groups in one figure panel, which takes care of a lot of the work for us!</p>
<p>To prepare our data for facet plotting, first we will pivot it longer:</p>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="two-group-comparisons-and-visualizations.html#cb422-1" aria-hidden="true" tabindex="-1"></a>biomarker_data_0vs4_long <span class="ot">&lt;-</span> biomarker_data_0vs4 <span class="sc">%&gt;%</span></span>
<span id="cb422-2"><a href="two-group-comparisons-and-visualizations.html#cb422-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="sc">-</span><span class="fu">c</span>(Donor, Dose), <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;value&quot;</span>)</span>
<span id="cb422-3"><a href="two-group-comparisons-and-visualizations.html#cb422-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb422-4"><a href="two-group-comparisons-and-visualizations.html#cb422-4" aria-hidden="true" tabindex="-1"></a><span class="fu">datatable</span>(biomarker_data_0vs4_long)</span></code></pre></div>
<div class="datatables html-widget html-fill-item" id="htmlwidget-87e8cb104e39db15dce3" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-87e8cb104e39db15dce3">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192"],["D10","D10","D10","D10","D10","D10","D10","D10","D10","D10","D10","D10","D11","D11","D11","D11","D11","D11","D11","D11","D11","D11","D11","D11","D12","D12","D12","D12","D12","D12","D12","D12","D12","D12","D12","D12","D13","D13","D13","D13","D13","D13","D13","D13","D13","D13","D13","D13","D14","D14","D14","D14","D14","D14","D14","D14","D14","D14","D14","D14","D15","D15","D15","D15","D15","D15","D15","D15","D15","D15","D15","D15","D16","D16","D16","D16","D16","D16","D16","D16","D16","D16","D16","D16","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D1","D2","D2","D2","D2","D2","D2","D2","D2","D2","D2","D2","D2","D3","D3","D3","D3","D3","D3","D3","D3","D3","D3","D3","D3","D4","D4","D4","D4","D4","D4","D4","D4","D4","D4","D4","D4","D5","D5","D5","D5","D5","D5","D5","D5","D5","D5","D5","D5","D6","D6","D6","D6","D6","D6","D6","D6","D6","D6","D6","D6","D7","D7","D7","D7","D7","D7","D7","D7","D7","D7","D7","D7","D8","D8","D8","D8","D8","D8","D8","D8","D8","D8","D8","D8","D9","D9","D9","D9","D9","D9","D9","D9","D9","D9","D9","D9"],["0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4","0","0","0","0","0","0","4","4","4","4","4","4"],["IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF","IL1B","IL6","IL8","IL10","TNFa","VEGF"],[3.71808758396052,8.68422263328295,15.0940690235359,0.189033824390017,1.73552217729654,10.4475275409266,3.6724253419715,7.55028504908841,16.7241460980745,1.0703893278914,2.83390207666916,11.2458081856384,3.83491342970104,10.2222394489088,15.0028356680746,2.3305584000308,3.23572705983806,9.02901108665907,3.81762325751143,8.03815081026938,16.0996069083821,1.64154602908752,3.48284828306847,9.316688823436939,3.36036427654347,9.27052894238072,13.9520295507825,0.526068811667588,1.63226821549951,9.428025110276749,3.10097764772482,7.61889934790406,16.3560077655342,0.333423733725192,1.57046293102604,7.3039633562453,3.35755200461808,8.15790268278964,14.30563571243,1.24488705912353,1.32192809488736,9.247642742898019,3.69041709553247,4.10265813136374,16.6038859325635,0.855989697308481,2.59931779369823,10.8557639471917,3.31614574229336,7.56094417806009,13.9567554773633,1.06350294230616,1.91456452349394,10.6537676442859,3.83086375675176,6.50969584193339,16.3613300730261,1.37295209791183,3.27202318906105,10.9341110109735,3.42894634476948,9.254131033541951,14.4305440239947,1.27500704749987,2.08746284125034,9.933439857942711,3.6915341649192,8.202809492125009,16.5368999542995,1.16992500144231,2.94485844580754,10.646036617491,3.38681094647222,8.68422263328295,14.3291992954213,0.8155754288625729,1.83187724119167,9.797969484059131,3.69376571221778,7.71163256182322,16.3717050181953,1.13750352374994,2.93168305705981,10.8557639471917,3.76871365703048,10.1099481540673,15.1620702745062,0.367371065648529,1.86393845042397,9.696480751820189,3.50589092972996,10.1498741117182,16.9008155214109,0.454175893185802,2.88362081628567,11.0193335777127,3.53480866123175,8.88962564051876,14.6079451777076,1.35614381022528,1.83187724119167,10.534828110721,3.75167794568758,4.87479696589866,17.2934204566841,1.40599235967584,2.98913900736823,11.031563370024,3.58014548442338,9.23160520814165,14.5987126147926,0.31034012061215,2.52606881166759,9.35887093968562,3.39643353125099,9.560179957764181,17.1264130896721,0.321928094887362,2.06695024392463,11.0217850685075,3.52732060787705,8.34837407519116,14.542155252148,0.879705766282288,2.47508488294878,8.283551423174311,4.13996056954546,7.70355756192103,15.3426552970282,2.03210084316702,3.73226919950145,8.973180744513019,3.16671544496642,3.9429835981871,14.1001424218123,0.933572638261024,2.20476675065461,9.425320822759881,3.799087306074,5.17871464117544,16.3510586187167,0.84799690655495,2.85798099512757,10.7035402591663,2.86195536414487,7.43212427264156,13.4034767756747,1.86393845042397,1.790772037862,10.7662472988462,3.64616265715789,8.36382813184704,16.2848127161883,0.443606651475615,2.16671544496642,9.89590846480624,3.04614178164472,8.12861303870471,13.5861396108168,0.650764559116902,1.56559717585423,10.3333342781343,3.42088657497553,8.90926307937532,17.0361832734254,1.17632277264046,2.75702324650746,11.7319596151152,3.37712374912949,11.4238722598684,14.1156143059506,1.01435529297707,2.53106949272595,9.92478281821723,3.8972404255748,8.52575569282949,15.1484821432167,1.57531233068744,3.47118746038699,9.40224465525408,3.21878116778407,7.01077983875324,14.3291992954213,2.51349074558812,1.0703893278914,9.797969484059131,3.7279204545632,4.70099449416827,16.3449160294487,1.47508488294878,3.08406426478847,10.9299462991725]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Donor<\/th>\n      <th>Dose<\/th>\n      <th>variable<\/th>\n      <th>value<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":4},{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"Donor","targets":1},{"name":"Dose","targets":2},{"name":"variable","targets":3},{"name":"value","targets":4}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
<p>Then, we can use similar code to what we used to make our single graph, with a few modifications to plot multiple panels simultaneously and adjust the style of the plot. Although it is beyond the scope of this module to explain the mechanics of each line of code, here are a few specific things to note about the code below that may be helpful when constructing similar plots:</p>
<ul>
<li>To create the plot with all six endpoints instead of just one, we:
<ul>
<li>Changed input dataframe from wide to long format</li>
<li>Changed <code>y =</code> from one specific endpoint to <code>value</code></li>
<li>Added the <code>facet_wrap()</code> argument
<ul>
<li><code>~ variable</code> tells the function to make an individual plot for each variable</li>
<li><code>nrow = 2</code> tells the function to put the plots into two rows</li>
<li><code>scales = "free_y"</code> tells the function to allow each individual graph to have a unique y-scale that best shows all of the data on that graph</li>
<li><code>labeller</code> feeds the edited (more stylistically correct) names for each panel to the function</li>
</ul></li>
</ul></li>
<li>To ensure that the statistical results appear cleanly, within <code>stat_compare_means()</code>, we:
<ul>
<li>Added <code>hide.ns = TRUE</code> so that only significant results are shown</li>
<li>Added <code>label.x.npc = "center"</code> and <code>hjust = 0.5</code> to ensure that asterisks are centered on the plot and that the text is center justified</li>
</ul></li>
<li>To add padding along the y axis, allowing space for significance asterisks, we added <code>scale_y_continuous(expand = expansion(mult = c(0.1, 0.4)))</code></li>
</ul>
<div class="sourceCode" id="cb423"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb423-1"><a href="two-group-comparisons-and-visualizations.html#cb423-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create clean labels for the graph titles</span></span>
<span id="cb423-2"><a href="two-group-comparisons-and-visualizations.html#cb423-2" aria-hidden="true" tabindex="-1"></a>new_labels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;IL10&quot;</span> <span class="ot">=</span> <span class="st">&quot;IL-10&quot;</span>, <span class="st">&quot;IL1B&quot;</span> <span class="ot">=</span> <span class="st">&quot;IL-1\u03B2 &quot;</span>, <span class="st">&quot;IL6&quot;</span> <span class="ot">=</span> <span class="st">&quot;IL-6&quot;</span>, <span class="st">&quot;IL8&quot;</span> <span class="ot">=</span> <span class="st">&quot;IL-8&quot;</span>, </span>
<span id="cb423-3"><a href="two-group-comparisons-and-visualizations.html#cb423-3" aria-hidden="true" tabindex="-1"></a>                <span class="st">&quot;TNFa&quot;</span> <span class="ot">=</span> <span class="st">&quot;TNF-\u03b1&quot;</span>, <span class="st">&quot;VEGF&quot;</span> <span class="ot">=</span> <span class="st">&quot;VEGF&quot;</span>)</span>
<span id="cb423-4"><a href="two-group-comparisons-and-visualizations.html#cb423-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb423-5"><a href="two-group-comparisons-and-visualizations.html#cb423-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Make graph</span></span>
<span id="cb423-6"><a href="two-group-comparisons-and-visualizations.html#cb423-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(biomarker_data_0vs4_long, <span class="fu">aes</span>(<span class="at">x =</span> Dose, <span class="at">y =</span> value)) <span class="sc">+</span></span>
<span id="cb423-7"><a href="two-group-comparisons-and-visualizations.html#cb423-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># outlier.shape = NA removes outliers</span></span>
<span id="cb423-8"><a href="two-group-comparisons-and-visualizations.html#cb423-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill =</span> Dose), <span class="at">outlier.shape =</span> <span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb423-9"><a href="two-group-comparisons-and-visualizations.html#cb423-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Changing box plot colors</span></span>
<span id="cb423-10"><a href="two-group-comparisons-and-visualizations.html#cb423-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;#BFBFBF&quot;</span>, <span class="st">&quot;#EE2B2B&quot;</span>)) <span class="sc">+</span></span>
<span id="cb423-11"><a href="two-group-comparisons-and-visualizations.html#cb423-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">size =</span> <span class="fl">1.5</span>, <span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>)) <span class="sc">+</span></span>
<span id="cb423-12"><a href="two-group-comparisons-and-visualizations.html#cb423-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding a p value from a paired Wilcoxon test</span></span>
<span id="cb423-13"><a href="two-group-comparisons-and-visualizations.html#cb423-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_compare_means</span>(<span class="at">method =</span> <span class="st">&quot;wilcox.test&quot;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>,</span>
<span id="cb423-14"><a href="two-group-comparisons-and-visualizations.html#cb423-14" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># Changing the value to asterisks and moving to the middle of the plot</span></span>
<span id="cb423-15"><a href="two-group-comparisons-and-visualizations.html#cb423-15" aria-hidden="true" tabindex="-1"></a>                     <span class="at">label =</span> <span class="st">&quot;p.signif&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>, <span class="at">hide.ns =</span> <span class="cn">TRUE</span>, <span class="at">label.x.npc =</span> <span class="st">&quot;center&quot;</span>,</span>
<span id="cb423-16"><a href="two-group-comparisons-and-visualizations.html#cb423-16" aria-hidden="true" tabindex="-1"></a>                     <span class="at">hjust =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb423-17"><a href="two-group-comparisons-and-visualizations.html#cb423-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Adding padding y axis </span></span>
<span id="cb423-18"><a href="two-group-comparisons-and-visualizations.html#cb423-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">expansion</span>(<span class="at">mult =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>))) <span class="sc">+</span></span>
<span id="cb423-19"><a href="two-group-comparisons-and-visualizations.html#cb423-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Changing y axis label</span></span>
<span id="cb423-20"><a href="two-group-comparisons-and-visualizations.html#cb423-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="fu">expression</span>(Log[<span class="dv">2</span>]<span class="sc">*</span><span class="st">&quot;(Concentration (pg/ml))&quot;</span>)) <span class="sc">+</span></span>
<span id="cb423-21"><a href="two-group-comparisons-and-visualizations.html#cb423-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Faceting by each biomarker</span></span>
<span id="cb423-22"><a href="two-group-comparisons-and-visualizations.html#cb423-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span> variable, <span class="at">nrow =</span> <span class="dv">2</span>, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">variable =</span> new_labels)) <span class="sc">+</span></span>
<span id="cb423-23"><a href="two-group-comparisons-and-visualizations.html#cb423-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Removing legend</span></span>
<span id="cb423-24"><a href="two-group-comparisons-and-visualizations.html#cb423-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>,</span>
<span id="cb423-25"><a href="two-group-comparisons-and-visualizations.html#cb423-25" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb423-26"><a href="two-group-comparisons-and-visualizations.html#cb423-26" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="sc">-</span><span class="fl">0.75</span>),</span>
<span id="cb423-27"><a href="two-group-comparisons-and-visualizations.html#cb423-27" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">vjust =</span> <span class="dv">2</span>),</span>
<span id="cb423-28"><a href="two-group-comparisons-and-visualizations.html#cb423-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="dv">10</span>),</span>
<span id="cb423-29"><a href="two-group-comparisons-and-visualizations.html#cb423-29" aria-hidden="true" tabindex="-1"></a>        <span class="at">strip.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">12</span>, <span class="at">face =</span> <span class="st">&quot;bold&quot;</span>))</span></code></pre></div>
<p><img src="04-Chapter4_files/figure-html/unnamed-chunk-95-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>An appropriate title for this figure could be:</p>
<p>“<strong>Figure X. Exposure to 4 ppm acrolein increases inflammatory biomarker secretion in primary human bronchial epithelial cells.</strong> Groups were compared using the Wilcoxon signed rank test. * p &lt; 0.05, ** p &lt; 0.01, *** p &lt; 0.001, **** p &lt; 0.0001, n = 16 per group (paired).”</p>
<p><br></p>
</div>
</div>
<div id="concluding-remarks-15" class="section level2 hasAnchor">
<h2>Concluding Remarks<a href="two-group-comparisons-and-visualizations.html#concluding-remarks-15" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this module, we introduced two-group statistical tests, which are some of the most common statistical tests applied in biomedical research. We applied these tests to our example dataset and demonstrated how to produce publication-quality tables and figures of our results. Implementing a workflow such as this enables efficient analysis of wet-bench generated data and customization of output figures and tables suited to your personal preferences.</p>
<p><br></p>
<p><label class="tykfont">
Test Your Knowledge
</label></p>
<div class="tyk">
<p>Functional endpoints from these cultures were also measured. These endpoints were: 1) Membrane Permeability (MemPerm), 2) Trans-Epithelial Electrical Resistance (TEER), 3) Ciliary Beat Frequency (CBF), and 4) Expression of Mucin (MUC5AC). These data were already processed and tested for normality (see Test Your Knowledge for <strong>TAME 2.0 Module 4.2 Data Import, Processing, and Summary Statistics</strong>), with results indicating that two of the endpoints are normally distributed and two non-normally distributed. Due to the relatively low <em>n</em> of this dataset, we therefore recommend using non-parametric statistical tests.</p>
<p>Use the same processes demonstrated in this module and the provided data (“Module4_4_TYKInput1.xlsx” (functional data) and “Module4_4_TYKInput2.xlsx” (demographic data)), run analyses and make publication-quality figures and tables to answer the following questions to determine:</p>
<ol style="list-style-type: decimal">
<li>Are there significant differences in functional endpoints between cells from male and female donors at baseline?</li>
<li>Are there significant differences in functional endpoints between cells exposed to 0 and 4 ppm acrolein? Go ahead and use non-parametric tests for these analyses.</li>
</ol>
</div>
<!-- ############################################################################################################################# -->
<!-- ################################################## -->
<!-- ################################################## -->
<!-- START SECTION FIVE  -->
<!-- ################################################## -->
<!-- ################################################## -->
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-import-from-pdf-sources.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="multi-group-and-multi-variable-comparisons-and-visualizations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
