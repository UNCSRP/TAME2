<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Improving Data Visualizations | TAME 2.0</title>
  <meta name="description" content="This is an example of how the TAME 2.0 website will look, I hope!" />
  <meta name="generator" content="bookdown 0.37 and GitBook 2.6.7" />

  <meta property="og:title" content="Improving Data Visualizations | TAME 2.0" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is an example of how the TAME 2.0 website will look, I hope!" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Improving Data Visualizations | TAME 2.0" />
  
  <meta name="twitter:description" content="This is an example of how the TAME 2.0 website will look, I hope!" />
  

<meta name="author" content="Rager Lab" />


<meta name="date" content="2024-06-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-visualizations.html"/>
<link rel="next" href="normality-tests-and-data-transformations.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>
<link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
<script src="libs/datatables-binding-0.32/datatables.js"></script>
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet" />
<link href="libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet" />
<script src="libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>
<link href="libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet" />
<script src="libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="images/Data Training Icon for Top Left Bookdown_v2.png"><br></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>TAME 2.0: Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#background"><i class="fa fa-check"></i>Background</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#objectives"><i class="fa fa-check"></i>Objectives</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#contributors-to-tame-2.0"><i class="fa fa-check"></i>Contributors to TAME 2.0</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#module-development-overview"><i class="fa fa-check"></i>Module Development Overview</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#ways-to-use-tame-2.0-and-underlying-site-license"><i class="fa fa-check"></i>Ways to use TAME 2.0 and Underlying Site License</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#concluding-remarks"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="part"><span><b>Chapter 1 Introductory <br>Data Science</b></span></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html"><i class="fa fa-check"></i>FAIR Data Management Practices</a>
<ul>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#introduction-to-training-module"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#introduction-to-fair"><i class="fa fa-check"></i>Introduction to FAIR</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#breaking-down-fair-letter-by-letter"><i class="fa fa-check"></i>Breaking Down FAIR, Letter-by-Letter</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#what-does-this-mean-for-you"><i class="fa fa-check"></i>What Does This Mean for You?</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#data-repositories-for-sharing-of-data"><i class="fa fa-check"></i>Data Repositories for Sharing of Data</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#recent-shifts-in-regulatory-policies-for-data-sharing"><i class="fa fa-check"></i>Recent Shifts in Regulatory Policies for Data Sharing</a></li>
<li class="chapter" data-level="" data-path="fair-data-management-practices.html"><a href="fair-data-management-practices.html#additional-training-resources-on-fair"><i class="fa fa-check"></i>Additional Training Resources on FAIR</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html"><i class="fa fa-check"></i>Data Sharing through Online Repositories</a>
<ul>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#an-overview-and-example-with-the-dataverse-repository"><i class="fa fa-check"></i>An Overview and Example with the Dataverse Repository</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#introduction-to-training-module-1"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#data-repositories"><i class="fa fa-check"></i>Data Repositories</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#the-dataverse-project"><i class="fa fa-check"></i>The Dataverse Project</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#what-is-a-dataverse"><i class="fa fa-check"></i>What is a Dataverse?</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#metadata"><i class="fa fa-check"></i>Metadata</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#creating-a-dataverse"><i class="fa fa-check"></i>Creating a Dataverse</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#creating-a-dataset"><i class="fa fa-check"></i>Creating a Dataset</a></li>
<li class="chapter" data-level="" data-path="data-sharing-through-online-repositories.html"><a href="data-sharing-through-online-repositories.html#concluding-remarks-1"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html"><i class="fa fa-check"></i>File Management using Github</a>
<ul>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#introduction-to-training-module-2"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#creating-an-account"><i class="fa fa-check"></i>Creating an Account</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#creating-a-repository"><i class="fa fa-check"></i>Creating a Repository</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#uploading-code"><i class="fa fa-check"></i>Uploading Code</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#adding-subfolders-in-a-repository"><i class="fa fa-check"></i>Adding Subfolders in a Repository</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#updating-code"><i class="fa fa-check"></i>Updating Code</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#updating-repository-titles-and-structure-to-support-a-manuscript"><i class="fa fa-check"></i>Updating Repository Titles and Structure to Support a Manuscript</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#tracking-code-changes-using-github-branches"><i class="fa fa-check"></i>Tracking Code Changes using Github Branches</a></li>
<li class="chapter" data-level="" data-path="file-management-using-github.html"><a href="file-management-using-github.html#concluding-remarks-2"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html"><i class="fa fa-check"></i>Data Wrangling in Excel</a>
<ul>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#introduction-to-training-module-3"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#save-a-copy-of-the-soon-to-be-organized-and-cleaned-dataset-as-a-new-file"><i class="fa fa-check"></i>Save a Copy of the Soon-To-Be Organized and Cleaned Dataset as a New File</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#remove-extraneous-white-space"><i class="fa fa-check"></i>Remove Extraneous White Space</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#replace-missing-data-with-na"><i class="fa fa-check"></i>Replace Missing Data with “NA”</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#create-a-metadata-tab"><i class="fa fa-check"></i>Create a Metadata Tab</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#abbreviate-and-capitalize-categorical-data"><i class="fa fa-check"></i>Abbreviate and Capitalize Categorical Data</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#alphabetize-sort-the-data-by-the-categorical-variable-of-interest"><i class="fa fa-check"></i>Alphabetize (Sort) the Data by the Categorical Variable of Interest</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#create-a-new-subject-number-column"><i class="fa fa-check"></i>Create a New Subject Number Column</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#remove-special-symbols-and-dashes"><i class="fa fa-check"></i>Remove Special Symbols and Dashes</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#bold-all-column-names-and-center-all-data"><i class="fa fa-check"></i>Bold all Column Names and Center all Data</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#create-a-subject-identifier-column"><i class="fa fa-check"></i>Create a Subject Identifier Column</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#separate-subject-demographic-data-from-experimental-measurements"><i class="fa fa-check"></i>Separate Subject Demographic Data from Experimental Measurements</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#convert-data-from-wide-to-long-format"><i class="fa fa-check"></i>Convert Data from Wide to Long Format</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#pivoting-data-from-a-wide-to-long-format"><i class="fa fa-check"></i>Pivoting Data from a Wide to Long Format</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#generating-summary-level-statistics-with-pivot-tables"><i class="fa fa-check"></i>Generating Summary-Level Statistics with Pivot Tables</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#excel-vs.-r-which-should-you-use"><i class="fa fa-check"></i>Excel vs. R: Which Should You Use?</a></li>
<li class="chapter" data-level="" data-path="data-wrangling-in-excel.html"><a href="data-wrangling-in-excel.html#concluding-remarks-3"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="part"><span><b>Chapter 2 Coding in R</b></span></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html"><i class="fa fa-check"></i>Downloading and Programming in R</a>
<ul>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#introduction-to-training-module-4"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#general-introduction-and-installation-of-r-and-rstudio"><i class="fa fa-check"></i>General Introduction and Installation of R and RStudio</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#introduction-to-r-packages"><i class="fa fa-check"></i>Introduction to R Packages</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#scripting-basics"><i class="fa fa-check"></i>Scripting Basics</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#code-troubleshooting"><i class="fa fa-check"></i>Code Troubleshooting</a></li>
<li class="chapter" data-level="" data-path="downloading-and-programming-in-r.html"><a href="downloading-and-programming-in-r.html#concluding-remarks-4"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html"><i class="fa fa-check"></i>Coding “Best” Practices</a>
<ul>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#introduction-to-training-module-5"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#scripting-file-types"><i class="fa fa-check"></i>Scripting File Types</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#script-headers-and-annotation"><i class="fa fa-check"></i>Script Headers and Annotation</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#coding-style"><i class="fa fa-check"></i>Coding Style</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#script-organization"><i class="fa fa-check"></i>Script Organization</a></li>
<li class="chapter" data-level="" data-path="coding-best-practices.html"><a href="coding-best-practices.html#concluding-remarks-5"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html"><i class="fa fa-check"></i>Data Manipulation and Reshaping</a>
<ul>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html#introduction-to-training-module-6"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html#data-manipulation-using-base-r"><i class="fa fa-check"></i>Data Manipulation Using Base R</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html#introduction-to-tidyverse"><i class="fa fa-check"></i>Introduction to Tidyverse</a></li>
<li class="chapter" data-level="" data-path="data-manipulation-and-reshaping.html"><a href="data-manipulation-and-reshaping.html#concluding-remarks-6"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html"><i class="fa fa-check"></i>Improving Coding Efficiencies</a>
<ul>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#introduction-to-training-module-7"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#loops"><i class="fa fa-check"></i>Loops</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#functions"><i class="fa fa-check"></i>Functions</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#list-operations"><i class="fa fa-check"></i>List operations</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#concluding-remarks-7"><i class="fa fa-check"></i>Concluding Remarks</a></li>
<li class="chapter" data-level="" data-path="improving-coding-efficiencies.html"><a href="improving-coding-efficiencies.html#additional-resources-2"><i class="fa fa-check"></i>Additional Resources</a></li>
</ul></li>
<li class="part"><span><b>Chapter 3 Basics of <br>Data Analysis and Visualizations</b></span></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html"><i class="fa fa-check"></i>Data Visualizations</a>
<ul>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#introduction-to-data-visualizations"><i class="fa fa-check"></i>Introduction to Data Visualizations</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#introduction-to-training-module-8"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#density-plot-visualization"><i class="fa fa-check"></i>Density Plot Visualization</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#boxplot-visualization"><i class="fa fa-check"></i>Boxplot Visualization</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#correlation-visualizations"><i class="fa fa-check"></i>Correlation Visualizations</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#heatmap-visualization"><i class="fa fa-check"></i>Heatmap Visualization</a></li>
<li class="chapter" data-level="" data-path="data-visualizations.html"><a href="data-visualizations.html#concluding-remarks-8"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html"><i class="fa fa-check"></i>Improving Data Visualizations</a>
<ul>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#introduction-to-data-visulization-conventions"><i class="fa fa-check"></i>Introduction to Data Visulization Conventions</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#introduction-to-training-module-9"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#creating-an-improved-boxplot-visualization"><i class="fa fa-check"></i>Creating an Improved Boxplot Visualization</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#creating-an-improved-heatmap-visualization"><i class="fa fa-check"></i>Creating an Improved Heatmap Visualization</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#creating-multi-plot-figures"><i class="fa fa-check"></i>Creating Multi-Plot Figures</a></li>
<li class="chapter" data-level="" data-path="improving-data-visualizations.html"><a href="improving-data-visualizations.html#concluding-remarks-9"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html"><i class="fa fa-check"></i>Normality Tests and Data Transformations</a>
<ul>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#introduction-to-training-module-10"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#what-is-a-normal-distribution"><i class="fa fa-check"></i>What is a Normal Distribution?</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#qualitative-assessment-of-normality"><i class="fa fa-check"></i>Qualitative Assessment of Normality</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#quantitative-normality-assessment"><i class="fa fa-check"></i>Quantitative Normality Assessment</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#data-transformation"><i class="fa fa-check"></i>Data Transformation</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#additional-considerations-regarding-normality"><i class="fa fa-check"></i>Additional Considerations Regarding Normality</a></li>
<li class="chapter" data-level="" data-path="normality-tests-and-data-transformations.html"><a href="normality-tests-and-data-transformations.html#concluding-remarks-10"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html"><i class="fa fa-check"></i>Intoduction to Statistical Tests</a>
<ul>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#introduction-to-training-module-11"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#assessing-normality-homogeneity-of-variance"><i class="fa fa-check"></i>Assessing Normality &amp; Homogeneity of Variance</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#two-group-visualizations-and-statistical-comparisons-using-the-t-test"><i class="fa fa-check"></i>Two-Group Visualizations and Statistical Comparisons using the T-Test</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#three-group-visualizations-and-statistical-comparisons-using-an-anova"><i class="fa fa-check"></i>Three-Group Visualizations and Statistical Comparisons using an ANOVA</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#regression-modeling-and-visualization-linear-and-logistic-regressions"><i class="fa fa-check"></i>Regression Modeling and Visualization: Linear and Logistic Regressions</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#statistical-evaluations-of-categorical-data-using-the-chi-squared-test-and-fishers-exact-test"><i class="fa fa-check"></i>Statistical Evaluations of Categorical Data using the Chi-Squared Test and Fisher’s Exact Test</a></li>
<li class="chapter" data-level="" data-path="intoduction-to-statistical-tests.html"><a href="intoduction-to-statistical-tests.html#concluding-remarks-11"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="part"><span><b>Chapter 4 Converting Wet Lab Data into Dry Lab Analyses</b></span></li>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html"><i class="fa fa-check"></i>Overview of Experimental Design and Example Data</a>
<ul>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html#introduction-to-training-module-12"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html#replicates"><i class="fa fa-check"></i>Replicates</a></li>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html#orientation-to-example-data-for-chapter-4"><i class="fa fa-check"></i>Orientation to Example Data for Chapter 4</a></li>
<li class="chapter" data-level="" data-path="overview-of-experimental-design-and-example-data.html"><a href="overview-of-experimental-design-and-example-data.html#concluding-remarks-12"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html"><i class="fa fa-check"></i>Data Import, Processing, and Summary Statistics</a>
<ul>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#introduction-to-training-module-13"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#data-import"><i class="fa fa-check"></i>Data Import</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#handling-missing-values"><i class="fa fa-check"></i>Handling Missing Values</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#averaging-replicates"><i class="fa fa-check"></i>Averaging Replicates</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#descriptive-statistics"><i class="fa fa-check"></i>Descriptive Statistics</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#normality-assessment-and-data-transformation"><i class="fa fa-check"></i>Normality Assessment and Data Transformation</a></li>
<li class="chapter" data-level="" data-path="data-import-processing-and-summary-statistics.html"><a href="data-import-processing-and-summary-statistics.html#concluding-remarks-13"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html"><i class="fa fa-check"></i>Data Import from PDF Sources</a>
<ul>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html#introduction-to-training-module-14"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html#importing-data-from-many-single-pdfs-with-the-same-formatting"><i class="fa fa-check"></i>Importing Data from Many Single PDFs with the Same Formatting</a></li>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html#importing-data-stored-in-pdf-tables"><i class="fa fa-check"></i>Importing Data Stored in PDF Tables</a></li>
<li class="chapter" data-level="" data-path="data-import-from-pdf-sources.html"><a href="data-import-from-pdf-sources.html#concluding-remarks-14"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html"><i class="fa fa-check"></i>Two-Group Comparisons and Visualizations</a>
<ul>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#introduction-to-training-module-15"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#overview-of-two-group-statistical-tests"><i class="fa fa-check"></i>Overview of Two Group Statistical Tests</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#statistical-vs-biological-significance"><i class="fa fa-check"></i>Statistical vs Biological Significance</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#unpaired-test-example"><i class="fa fa-check"></i>Unpaired Test Example</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#paired-test-example"><i class="fa fa-check"></i>Paired Test Example</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#visualizing-results"><i class="fa fa-check"></i>Visualizing Results</a></li>
<li class="chapter" data-level="" data-path="two-group-comparisons-and-visualizations.html"><a href="two-group-comparisons-and-visualizations.html#concluding-remarks-15"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html"><i class="fa fa-check"></i>Multi-Group and Multi-Variable Comparisons and Visualizations</a>
<ul>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#introduction-to-training-module-16"><i class="fa fa-check"></i>Introduction to Training Module</a></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#overview-of-multi-group-statistical-tests"><i class="fa fa-check"></i>Overview of Multi-Group Statistical Tests</a></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#multi-group-analysis-example"><i class="fa fa-check"></i>Multi-Group Analysis Example</a></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#visualization-of-multi-group-statistical-results"><i class="fa fa-check"></i>Visualization of Multi-Group Statistical Results</a></li>
<li class="chapter" data-level="" data-path="multi-group-and-multi-variable-comparisons-and-visualizations.html"><a href="multi-group-and-multi-variable-comparisons-and-visualizations.html#concluding-remarks-16"><i class="fa fa-check"></i>Concluding Remarks</a></li>
</ul></li>
<li class="part"><span><b>Chapter 5 Machine Learning &amp; Artificial Intelligence</b></span></li>
<li class="part"><span><b>Chapter 6 Applications in Toxicology &amp; Exposure Science</b></span></li>
<li class="part"><span><b>Chapter 7 Environmental Health Database Mining</b></span></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">TAME 2.0</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="improving-data-visualizations" class="section level1 hasAnchor">
<h1>Improving Data Visualizations<a href="improving-data-visualizations.html#improving-data-visualizations" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>This training module was developed by Alexis Payton, Elise Hickman, and Julia E. Rager.</p>
<p>All input files (script, data, and figures) can be downloaded from the <a href="https://github.com/UNCSRP/TAME2">UNC-SRP TAME2 GitHub website</a>.</p>
<div id="introduction-to-data-visulization-conventions" class="section level2 hasAnchor">
<h2>Introduction to Data Visulization Conventions<a href="improving-data-visualizations.html#introduction-to-data-visulization-conventions" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Data visualizations are used to convey key takeaways from a research study’s findings in a clear, succinct manner to highlight data trends, patterns, and/or relationships. In environmental health research, this is of particular importance for high-dimensional datasets that can typically be parsed using multiple methods, potentially resulting in many different approaches to visualize data. As a consequence, researchers are often faced with an overwhelming amount of options when deciding which visualization scheme(s) most optimally translate their results for effective dissemination. Effective data visualization approaches are vital to a researcher’s success for many reasons. For instance, manuscript readers or peer reviewers often scroll through a study’s text and focus on the quality and novelty of study figures before deciding whether to read/review the paper. Therefore, the importance of data visualizations cannot be understated in any research field.</p>
<p>As a high-level introduction, it is important that we first communicate some traits that we think are imperative towards ensuring a successful data visualization approach as described in more detail below.</p>
<p>Keys to successful data visualizations:</p>
<ul>
<li><p><strong>Consider your audience, data type, and research question prior to selecting a figure to visualize your data</strong></p>
<p>For example, if more computationally complex methods are used in a manuscript that is intended for a journal with an audience that doesn’t have that same level of expertise, consider spending time focusing on how those results are presented in an approachable way for that audience. For a review of how to choose a rudimentary chart based on the data type, check out <a href="https://www.atlassian.com/data/charts/how-to-choose-data-visualization">How to Choose the Right Data Visualization</a>. Some of these basic charts will be presented in this module, while more complex analysis-specific visualizations, especially ones developed for high-dimensional data will be presented in later modules.</p></li>
<li><p><strong>Take the legibility of the figure into account</strong></p>
<p>This includes avoiding abbreviations when possible. (If they can’t be avoided explain them in the caption.) All titles should be capitalized, including titles for the legend(s) and axes. Underscores and periods between words should be replaced with spaces. Consider the legibility of the figure if printed in black and white. (However, that’s not as important these days.) Lastly, feel free to describe your plot in further detail in the caption to aid the reader in understanding the results presented.</p></li>
<li><p><strong>Minimize text</strong></p>
<p>Main titles aren’t necessary for single paneled figures (like the examples below), because in a publication the title of the figure is right underneath each figure. It’s good practice to remove this kind of extraneous text, which can make the figure seem more cluttered. Titles can be helpful in multi-panel figures, especially if there are multiple panels with the same figure type that present slightly different results. For example, in the Test Your Knowledge section, you’ll need to create two heatmaps, but one displays data under smoldering conditions and the other displays data under flaming conditions. In general, try to reduce the amount of extraneous text in a plot to keep a reader focused on the most important elements and takeaways in the plot.</p></li>
<li><p><strong>Use the minimal number of figures you need to support your narrative</strong></p>
<p>It is important to include an optimal number of figures within manuscripts and scientific reports. Too many figures might overwhelm the overall narrative, while too few might not provide enough substance to support your main findings. It can be helpful to also consider placing some figures in supplemental material to aid in the overall flow of your scientific writing.</p></li>
<li><p><strong>Select an appropriate color palette</strong></p>
<p>Packages have been developed to offer color palettes including <em>MetBrewer</em> and <em>RColorBrewer</em>. In addition, <em>ggsci</em> is a package that offers a collection of color palettes used in various scientific journals. For more information, check out <em>MetBrewer</em>, see its associated <a href="https://cran.r-project.org/web/packages/MetBrewer/index.html">RDocumentation</a> and <a href="https://github.com/BlakeRMills/MetBrewer">example tutorial</a>. For more information on <em>RColorBrewer</em>, see its associated <a href="https://cran.r-project.org/web/packages/RColorBrewer/index.html">RDocumentation</a> and <a href="https://r-graph-gallery.com/38-rcolorbrewers-palettes.html">example tutorial</a>. For more information on <em>ggsci</em>, see its associated <a href="https://cran.r-project.org/web/packages/ggsci/vignettes/ggsci.html">RDocumentation</a>. In general, it’s better to avoid bright and flashy colors that can be difficult to read.</p>
<p>It’s advisable to use colors for manuscript figures that are color-blind friendly. Check out these <a href="https://stackoverflow.com/questions/57153428/r-plot-color-combinations-that-are-colorblind-accessible">Stack overflow answers about color blind-safe color palettes and packages</a>. Popular packages for generating colorblind-friendly palettes include <a href="https://cran.r-project.org/web/packages/viridis/vignettes/intro-to-viridis.html">viridis</a> and <a href="https://github.com/Nowosad/rcartocolor">rcartocolor</a>.</p></li>
<li><p><strong>Use color strategically</strong></p>
<p>Color can be used to visualize a variable. There are three ways to categorize color schemes - sequential, diverging, and qualitative. Below, definitions are provided for each along with example figures that we’ve previously published that illustrate each color scheme. In addition, figure titles and captions are also provided for context. Note that some of these figures have been simplified from what was originally published to show more streamlined examples for TAME.</p>
<ul>
<li><strong>Sequential</strong>: intended for ordered categorical data (i.e., disease severity, likert scale, quintiles). The choropleth map below is from <a href="https://doi.org/10.3389/fpubh.2024.1339700">Winker, Payton et. al</a>.
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-18"></span>
<img src="Module3_2_Input/Module3_2_Image1.png" alt="**Figure 1. Geospatial distribution of the risk of future wildfire events across North Carolina.** Census tracts in North Carolina were binned into quintiles based on Wildfire Hazard Potential (WHP) with 1 (pale orange) having the lowest risk and 5 (dark red) having the highest risk. Figure regenerated here in alignment with its published [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/)" width="65%" />
<p class="caption">
Figure 3: <strong>Figure 1. Geospatial distribution of the risk of future wildfire events across North Carolina.</strong> Census tracts in North Carolina were binned into quintiles based on Wildfire Hazard Potential (WHP) with 1 (pale orange) having the lowest risk and 5 (dark red) having the highest risk. Figure regenerated here in alignment with its published <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
</p>
</div></li>
<li><strong>Diverging</strong>: intended to emphasize continuous data at extremes of the data range (typically using darker colors) and mid-range values (typically using lighter colors). This color scheme is ideal for charts like heatmaps. The heatmap below is from <a href="0.1152/ajplung.00299.2021">Payton, Perryman et. al</a>.
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-19"></span>
<img src="Module3_2_Input/Module3_2_Image2.png" alt="**Figure 6. Individual cytokine expression levels across all subjects.** Cytokine concentrations were derived from nasal lavage fluid samples. On the x axis, subjects were ordered first according to tobacco use status, starting with non-smokers then cigarette smokers and e-cigarette users. Within tobacco use groups, subjects are ordered from lowest to highest average cytokine concentration from left to right. Within each cluster shown on the y axis, cytokines are ordered from lowest to highest average cytokine concentration from bottom to top. Figure regenerated here in alignment with its published [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/)" width="90%" />
<p class="caption">
Figure 4: <strong>Figure 6. Individual cytokine expression levels across all subjects.</strong> Cytokine concentrations were derived from nasal lavage fluid samples. On the x axis, subjects were ordered first according to tobacco use status, starting with non-smokers then cigarette smokers and e-cigarette users. Within tobacco use groups, subjects are ordered from lowest to highest average cytokine concentration from left to right. Within each cluster shown on the y axis, cytokines are ordered from lowest to highest average cytokine concentration from bottom to top. Figure regenerated here in alignment with its published <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
</p>
</div></li>
<li><strong>Qualitative</strong>: intended for nominal categorical data to visualize clear differences between groups (i.e., soil types and exposure groups). The dendrogram below is from <a href="10.1038/s41370-022-00451-8">Koval et. al</a>.
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="Module3_2_Input/Module3_2_Image3.png" alt="**Figure 2. Translating chemical use inventory data to inform human exposure patterning.** Groups A-I illustrate the identified clusters of exposure source categories. Figure regenerated here in alignment with its published [Creative Commons Attribution 4.0 International License](https://creativecommons.org/licenses/by/4.0/)" width="75%" />
<p class="caption">
Figure 5: <strong>Figure 2. Translating chemical use inventory data to inform human exposure patterning.</strong> Groups A-I illustrate the identified clusters of exposure source categories. Figure regenerated here in alignment with its published <a href="https://creativecommons.org/licenses/by/4.0/">Creative Commons Attribution 4.0 International License</a>
</p>
</div></li>
</ul></li>
<li><p><strong>Consider ordering axes to reveal patterns relevant to the research questions</strong></p>
<p>Ordering the axes can reveal potential patterns that may not be clear in the visualization otherwise. In the cytokine expression heatmap above, there are not clear differences in cytokine expression across the tobacco use groups. However, e-cigarette users seem to have slightly more muted responses compared to non-smokers and cigarette smokers in clusters B and C, which was corroborated in subsequent statistical analyses. It is also evident that Cluster A had the lowest cytokine concentrations, followed by Cluster B, and then Cluster C with the greatest concentrations.</p></li>
</ul>
<p>What makes these figures so compelling is how the aspects introduced above were thoughtfully incorporated. In the next section, we’ll put those principles into practice using data that were described and referenced previously in <strong>TAME 2.0 Module 3.1 Data Visualizations</strong>.</p>
<p><br></p>
</div>
<div id="introduction-to-training-module-9" class="section level2 hasAnchor">
<h2>Introduction to Training Module<a href="improving-data-visualizations.html#introduction-to-training-module-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In this module, <em>ggplot2</em>, R’s data visualization package will be used to walk through ways to improve data visualizations. We’ll recreate two figures (i.e., the boxplot and heatmap) constructed previously in <strong>TAME 2.0 Module 3.1 Data Visualizations</strong> and improve them so they are publication-ready. Additionally, we’ll write figure titles and captions to contextualize the results presented for each visualization. When writing figure titles and captions, it is helpful to address the research question or overall concept that the figure seeks to capture rather than getting into the weeds of specific methods the plot is based on. This is especially important when visualizing more complex methods that your audience might not have as much knowledge on.</p>
<div id="script-preparations-1" class="section level3 hasAnchor">
<h3>Script Preparations<a href="improving-data-visualizations.html#script-preparations-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div id="cleaning-the-global-environment-1" class="section level4 hasAnchor">
<h4>Cleaning the global environment<a href="improving-data-visualizations.html#cleaning-the-global-environment-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="improving-data-visualizations.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>())</span></code></pre></div>
</div>
<div id="installing-required-r-packages-1" class="section level4 hasAnchor">
<h4>Installing required R packages<a href="improving-data-visualizations.html#installing-required-r-packages-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>If you already have these packages installed, you can skip this step, or you can run the below code which checks installation status for you</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="improving-data-visualizations.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;MetBrewer&quot;</span>))</span>
<span id="cb206-2"><a href="improving-data-visualizations.html#cb206-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;MetBrewer&quot;</span>);</span>
<span id="cb206-3"><a href="improving-data-visualizations.html#cb206-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;RColorBrewer&quot;</span>))</span>
<span id="cb206-4"><a href="improving-data-visualizations.html#cb206-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;RColorBrewer&quot;</span>);</span>
<span id="cb206-5"><a href="improving-data-visualizations.html#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;pheatmap&quot;</span>))</span>
<span id="cb206-6"><a href="improving-data-visualizations.html#cb206-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;pheatmap&quot;</span>);</span>
<span id="cb206-7"><a href="improving-data-visualizations.html#cb206-7" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;cowplot&quot;</span>))</span>
<span id="cb206-8"><a href="improving-data-visualizations.html#cb206-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;cowplot&quot;</span>);</span></code></pre></div>
</div>
<div id="loading-required-r-packages" class="section level4 hasAnchor">
<h4>Loading required R packages<a href="improving-data-visualizations.html#loading-required-r-packages" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="improving-data-visualizations.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb207-2"><a href="improving-data-visualizations.html#cb207-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MetBrewer)</span>
<span id="cb207-3"><a href="improving-data-visualizations.html#cb207-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb207-4"><a href="improving-data-visualizations.html#cb207-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb207-5"><a href="improving-data-visualizations.html#cb207-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cowplot)</span></code></pre></div>
</div>
<div id="set-your-working-directory-2" class="section level4 hasAnchor">
<h4>Set your working directory<a href="improving-data-visualizations.html#set-your-working-directory-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="improving-data-visualizations.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">&quot;/filepath to where your input files are&quot;</span>)</span></code></pre></div>
</div>
<div id="importing-example-dataset-2" class="section level4 hasAnchor">
<h4>Importing example dataset<a href="improving-data-visualizations.html#importing-example-dataset-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s now read in our example dataset. As mentioned in the introduction, this example dataset represents chemical measurements across 12 different biomass burn scenarios, representing chemicals emitted during potential wildfire events. Let’s upload and view these data:</p>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="improving-data-visualizations.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Load the data</span></span>
<span id="cb209-2"><a href="improving-data-visualizations.html#cb209-2" aria-hidden="true" tabindex="-1"></a>smoke_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;Module3_2_Input/Module3_2_InputData.csv&quot;</span>)</span>
<span id="cb209-3"><a href="improving-data-visualizations.html#cb209-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb209-4"><a href="improving-data-visualizations.html#cb209-4" aria-hidden="true" tabindex="-1"></a><span class="co"># View the top of the dataset</span></span>
<span id="cb209-5"><a href="improving-data-visualizations.html#cb209-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(smoke_data) </span></code></pre></div>
<pre><code>##   Chemical.Category           Chemical     CASRN Eucalyptus_Smoldering
## 1         n-Alkanes 2-Methylnonadecane 1560-86-7                  0.06
## 2         n-Alkanes 3-Methylnonadecane 6418-45-7                  0.04
## 3         n-Alkanes           Docosane  629-97-0                  0.21
## 4         n-Alkanes Dodecylcyclohexane 1795-17-1                  0.04
## 5         n-Alkanes           Eicosane  112-95-8                  0.11
## 6         n-Alkanes        Heneicosane  629-94-7                  0.13
##   Eucalyptus_Flaming Peat_Smoldering Peat_Flaming Pine_Smoldering Pine_Flaming
## 1               0.06            1.36         0.06            0.06         0.06
## 2               0.04            1.13         0.90            0.47         0.04
## 3               0.25            9.46         0.57            0.16         0.48
## 4               0.04            0.25         0.04            0.04         0.04
## 5               0.25            7.55         0.54            0.17         0.29
## 6               0.28            6.77         0.34            0.13         0.42
##   Pine_Needles_Smoldering Pine_Needles_Flaming Red_Oak_Smoldering
## 1                    0.06                 0.06               0.06
## 2                    0.04                 0.72               0.04
## 3                    0.32                 0.18               0.16
## 4                    0.12                 0.04               0.04
## 5                    0.28                 0.16               0.15
## 6                    0.30                 0.13               0.13
##   Red_Oak_Flaming     Units
## 1            0.13 ng_per_uL
## 2            0.77 ng_per_uL
## 3            0.36 ng_per_uL
## 4            0.04 ng_per_uL
## 5            0.38 ng_per_uL
## 6            0.69 ng_per_uL</code></pre>
<p>Now that we’ve been able to view the dataset, let’s come up with questions that can be answered with our boxplot and heatmap figure. This will inform how we format the dataframe for visualization.</p>
</div>
</div>
<div id="training-modules-environmental-health-questions-3" class="section level3 hasAnchor">
<h3>Training Module’s Environmental Health Questions<a href="improving-data-visualizations.html#training-modules-environmental-health-questions-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>This training module was specifically developed to answer the following environmental health questions:</p>
<ol style="list-style-type: decimal">
<li>Boxplot: How do the distributions of the chemical concentration data differ based on each biomass burn scenario?</li>
<li>Heatmap: Which classes of chemicals show the highest concentrations across the evaluated biomass burn conditions?</li>
<li>How can these figures be combined into a single plot that can be then be exported from R?</li>
</ol>
<div id="formatting-dataframes-for-downstream-visualization-code" class="section level4 hasAnchor">
<h4>Formatting dataframes for downstream visualization code<a href="improving-data-visualizations.html#formatting-dataframes-for-downstream-visualization-code" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, format the dataframe by changing it from a wide to long format and normalizing the chemical concentration data. For more details on this data reshaping visit <strong>TAME 2.0 Module 2.3 Data Manipulation &amp; Reshaping</strong>.</p>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="improving-data-visualizations.html#cb211-1" aria-hidden="true" tabindex="-1"></a>scaled_longer_smoke_data <span class="ot">=</span> <span class="fu">pivot_longer</span>(smoke_data, <span class="at">cols =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">13</span>, <span class="at">names_to =</span> <span class="st">&quot;Biomass_Burn_Condition&quot;</span>, </span>
<span id="cb211-2"><a href="improving-data-visualizations.html#cb211-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">values_to =</span> <span class="st">&quot;Chemical_Concentration&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb211-3"><a href="improving-data-visualizations.html#cb211-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># scaling within each chemical</span></span>
<span id="cb211-4"><a href="improving-data-visualizations.html#cb211-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Chemical) <span class="sc">%&gt;%</span></span>
<span id="cb211-5"><a href="improving-data-visualizations.html#cb211-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Scaled_Chemical_Concentration =</span> <span class="fu">scale</span>(Chemical_Concentration)) <span class="sc">%&gt;%</span></span>
<span id="cb211-6"><a href="improving-data-visualizations.html#cb211-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span>
<span id="cb211-7"><a href="improving-data-visualizations.html#cb211-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb211-8"><a href="improving-data-visualizations.html#cb211-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scaled_longer_smoke_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   Chemical.Category Chemical           CASRN     Units    Biomass_Burn_Condition
##   &lt;chr&gt;             &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;                 
## 1 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Eucalyptus_Smoldering 
## 2 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Eucalyptus_Flaming    
## 3 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Peat_Smoldering       
## 4 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Peat_Flaming          
## 5 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Pine_Smoldering       
## 6 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Pine_Flaming          
## # ℹ 2 more variables: Chemical_Concentration &lt;dbl&gt;,
## #   Scaled_Chemical_Concentration &lt;dbl[,1]&gt;</code></pre>
<p><br></p>
</div>
</div>
</div>
<div id="creating-an-improved-boxplot-visualization" class="section level2 hasAnchor">
<h2>Creating an Improved Boxplot Visualization<a href="improving-data-visualizations.html#creating-an-improved-boxplot-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we did in the previous module, a boxplot will be constructed to answer the first environmental heath question: <strong>How do the distributions of the chemical concentration data differ based on each biomass burn scenario?</strong>. Let’s remind ourselves of the original figure from the previous module.</p>
<p><img src="03-Chapter3_files/figure-html/unnamed-chunk-25-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Based on the figure above, peat smoldering has the highest median scaled chemical concentration. However, this was difficult to determine given that the burn conditions aren’t labeled on the x axis and a sequential color palette was used, making it difficult to identify the correct boxplot with its burn condition in the legend. If you look closely, the colors in the legend are in a reverse order of the colors assigned to the boxplots. Let’s identify some elements of this graph that can be modified to make it easier to answer our research question.</p>
<div id="there-are-four-main-aspects-we-can-adjust-on-this-figure" class="section level3 hasAnchor txtbx">
<h3>There are four main aspects we can adjust on this figure:<a href="improving-data-visualizations.html#there-are-four-main-aspects-we-can-adjust-on-this-figure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>1. The legibility of the text in the legend and axes.</strong></p>
<p>Creating spaces between the text or exchanging the underscores for spaces improves the legibility of the figure.</p>
<p><strong>2. The order of the boxplots.</strong></p>
<p>Ordering the biomass burn conditions from highest to lowest based on their median scaled chemical concentration allows the reader to easily determine the biomass burn condition that had the greatest or least chemical concentrations relative to each other. In R, this can be done by putting the <code>Biomass_Burn_Condition</code> variable into a factor.</p>
<p><strong>3. Use of color.</strong></p>
<p>Variables can be visualized using color, text, size, etc. In this figure, it is redundant to have the biomass burn condition encoded in the legend and the color. Instead this variable can be put on the y axis and the legend will be removed to be more concise. The shades of the colors will also be changed, but to keep each burn condition distinct from each other, colors will be chosen that are distinct from one another. Therefore, we will choose a qualitative color scheme.</p>
<p><strong>4. Show all data points when possible.</strong></p>
<p>Many journals now require that authors report every single value when making data visualizations, particularly for small <em>n</em> studies using bar graphs and boxplots to show results. Instead of just displaying the mean/median and surrounding data range, it is advised to show how every replicate landed in the study range when possible. Note that this requirement is not feasible for studies with larger sample sizes though should be considered for smaller <em>in vitro</em> and animal model studies.</p>
</div>
<p>Let’s start with addressing <strong>#1: Legibility of Axis Text</strong>. The legend title and axis titles can easily be changed with <code>ggplot()</code>, so that will be done later. To remove the underscore from the <code>Biomass_Burn_Condition</code> column, we can use the function <code>gsub()</code>, which will replace all of the underscores with spaces, resulting in a cleaner-looking graph.</p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="improving-data-visualizations.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First adding spaces between the biomass burn conditions</span></span>
<span id="cb213-2"><a href="improving-data-visualizations.html#cb213-2" aria-hidden="true" tabindex="-1"></a>scaled_longer_smoke_data <span class="ot">=</span> scaled_longer_smoke_data <span class="sc">%&gt;%</span></span>
<span id="cb213-3"><a href="improving-data-visualizations.html#cb213-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Biomass_Burn_Condition =</span> <span class="fu">gsub</span>(<span class="st">&quot;_&quot;</span>, <span class="st">&quot; &quot;</span>, Biomass_Burn_Condition))</span>
<span id="cb213-4"><a href="improving-data-visualizations.html#cb213-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb213-5"><a href="improving-data-visualizations.html#cb213-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Viewing dataframe</span></span>
<span id="cb213-6"><a href="improving-data-visualizations.html#cb213-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scaled_longer_smoke_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   Chemical.Category Chemical           CASRN     Units    Biomass_Burn_Condition
##   &lt;chr&gt;             &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt;    &lt;chr&gt;                 
## 1 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Eucalyptus Smoldering 
## 2 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Eucalyptus Flaming    
## 3 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Peat Smoldering       
## 4 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Peat Flaming          
## 5 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Pine Smoldering       
## 6 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Pine Flaming          
## # ℹ 2 more variables: Chemical_Concentration &lt;dbl&gt;,
## #   Scaled_Chemical_Concentration &lt;dbl[,1]&gt;</code></pre>
<p><strong>#2. Reordering the boxplots based on the median scaled chemical concentration</strong>.
After calculating the median scaled chemical concentration for each biomass burn condition, the new dataframe will be arranged from lowest to highest median scaled concentration from the top of the dataframe to the bottom. This order will be saved in a vector, <code>median_biomass_order</code>. Although the biomass burn conditions are saved from lowest to highest concentration, <code>ggplot()</code> will plot them in reverse order with the highest concentration at the top and the lowest at the bottom of the y axis.</p>
<p>Axis reordering can also be accomplished using <code>reorder</code> within the <code>ggplot()</code> function as described <a href="https://guslipkin.medium.com/reordering-bar-and-column-charts-with-ggplot2-in-r-435fad1c643e">here</a> and <a href="https://r-graph-gallery.com/267-reorder-a-variable-in-ggplot2.html">here</a>.</p>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="improving-data-visualizations.html#cb215-1" aria-hidden="true" tabindex="-1"></a>median_biomass <span class="ot">=</span> scaled_longer_smoke_data <span class="sc">%&gt;%</span></span>
<span id="cb215-2"><a href="improving-data-visualizations.html#cb215-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Biomass_Burn_Condition) <span class="sc">%&gt;%</span></span>
<span id="cb215-3"><a href="improving-data-visualizations.html#cb215-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Median_Concentration =</span> <span class="fu">median</span>(Scaled_Chemical_Concentration)) <span class="sc">%&gt;%</span></span>
<span id="cb215-4"><a href="improving-data-visualizations.html#cb215-4" aria-hidden="true" tabindex="-1"></a>    <span class="co"># arranges dataframe from lowest to highest from top to bottom</span></span>
<span id="cb215-5"><a href="improving-data-visualizations.html#cb215-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(Median_Concentration)</span>
<span id="cb215-6"><a href="improving-data-visualizations.html#cb215-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb215-7"><a href="improving-data-visualizations.html#cb215-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(median_biomass)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   Biomass_Burn_Condition  Median_Concentration
##   &lt;chr&gt;                                  &lt;dbl&gt;
## 1 Red Oak Smoldering                    -0.459
## 2 Eucalyptus Smoldering                 -0.451
## 3 Pine Smoldering                       -0.424
## 4 Pine Needles Smoldering               -0.370
## 5 Pine Needles Flaming                  -0.350
## 6 Red Oak Flaming                       -0.337</code></pre>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="improving-data-visualizations.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving that order</span></span>
<span id="cb217-2"><a href="improving-data-visualizations.html#cb217-2" aria-hidden="true" tabindex="-1"></a>median_biomass_order <span class="ot">=</span> median_biomass<span class="sc">$</span>Biomass_Burn_Condition</span></code></pre></div>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="improving-data-visualizations.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Putting into factor to organize the burn conditions</span></span>
<span id="cb218-2"><a href="improving-data-visualizations.html#cb218-2" aria-hidden="true" tabindex="-1"></a>scaled_longer_smoke_data<span class="sc">$</span>Biomass_Burn_Condition <span class="ot">=</span> <span class="fu">factor</span>(scaled_longer_smoke_data<span class="sc">$</span>Biomass_Burn_Condition, </span>
<span id="cb218-3"><a href="improving-data-visualizations.html#cb218-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">levels =</span> median_biomass_order)</span>
<span id="cb218-4"><a href="improving-data-visualizations.html#cb218-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb218-5"><a href="improving-data-visualizations.html#cb218-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Final dataframe to be used for plotting</span></span>
<span id="cb218-6"><a href="improving-data-visualizations.html#cb218-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scaled_longer_smoke_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
##   Chemical.Category Chemical           CASRN     Units    Biomass_Burn_Condition
##   &lt;chr&gt;             &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt;    &lt;fct&gt;                 
## 1 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Eucalyptus Smoldering 
## 2 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Eucalyptus Flaming    
## 3 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Peat Smoldering       
## 4 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Peat Flaming          
## 5 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Pine Smoldering       
## 6 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Pine Flaming          
## # ℹ 2 more variables: Chemical_Concentration &lt;dbl&gt;,
## #   Scaled_Chemical_Concentration &lt;dbl[,1]&gt;</code></pre>
<p>Now that the dataframe has been finalized, we can plot the new boxplot. The final revision, <strong>#3: Making Use of Color</strong>, will be addressed with <code>ggplot()</code>. However, a palette can be chosen from the <em>MetBrewer</em> package.</p>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="improving-data-visualizations.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Choosing the &quot;Jurarez&quot; palette from the `MetBrewer` package</span></span>
<span id="cb220-2"><a href="improving-data-visualizations.html#cb220-2" aria-hidden="true" tabindex="-1"></a><span class="co"># `n = 12`, since there are 12 biomass burn conditions</span></span>
<span id="cb220-3"><a href="improving-data-visualizations.html#cb220-3" aria-hidden="true" tabindex="-1"></a>juarez_colors <span class="ot">=</span> <span class="fu">met.brewer</span>(<span class="at">name =</span> <span class="st">&quot;Juarez&quot;</span>, <span class="at">n =</span> <span class="dv">12</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>]</span></code></pre></div>
<p><strong>#4. Show all data points when possible</strong> will also be addressed with <code>ggplot()</code> by simply using <code>geom_point()</code>.</p>
<div class="sourceCode" id="cb221"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="improving-data-visualizations.html#cb221-1" aria-hidden="true" tabindex="-1"></a>FigureX1 <span class="ot">=</span> <span class="fu">ggplot</span>(scaled_longer_smoke_data, <span class="fu">aes</span>(<span class="at">x =</span> Scaled_Chemical_Concentration, <span class="at">y =</span> Biomass_Burn_Condition, </span>
<span id="cb221-2"><a href="improving-data-visualizations.html#cb221-2" aria-hidden="true" tabindex="-1"></a>                                   <span class="at">color =</span> Biomass_Burn_Condition)) <span class="sc">+</span> </span>
<span id="cb221-3"><a href="improving-data-visualizations.html#cb221-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb221-4"><a href="improving-data-visualizations.html#cb221-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># jittering the points, so they&#39;re not all on top of each other and adding transparency</span></span>
<span id="cb221-5"><a href="improving-data-visualizations.html#cb221-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">h =</span> <span class="fl">0.1</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>) <span class="sc">+</span> </span>
<span id="cb221-6"><a href="improving-data-visualizations.html#cb221-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-7"><a href="improving-data-visualizations.html#cb221-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_light</span>() <span class="sc">+</span> <span class="co"># changing the theme</span></span>
<span id="cb221-8"><a href="improving-data-visualizations.html#cb221-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>), <span class="co"># changing size of axis labels</span></span>
<span id="cb221-9"><a href="improving-data-visualizations.html#cb221-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>)), <span class="co"># changes axis titles</span></span>
<span id="cb221-10"><a href="improving-data-visualizations.html#cb221-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.position =</span> <span class="st">&quot;none&quot;</span>) <span class="sc">+</span> <span class="co"># removes legend</span></span>
<span id="cb221-11"><a href="improving-data-visualizations.html#cb221-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-12"><a href="improving-data-visualizations.html#cb221-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&#39;Scaled Chemical Concentration (pg/uL)&#39;</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">&#39;Biomass Burn Condition&#39;</span>) <span class="sc">+</span> <span class="co"># changing axis labels </span></span>
<span id="cb221-13"><a href="improving-data-visualizations.html#cb221-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(juarez_colors)) <span class="co"># changing the colors</span></span>
<span id="cb221-14"><a href="improving-data-visualizations.html#cb221-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb221-15"><a href="improving-data-visualizations.html#cb221-15" aria-hidden="true" tabindex="-1"></a>FigureX1</span></code></pre></div>
<p><img src="03-Chapter3_files/figure-html/unnamed-chunk-30-1.png" width="75%" height="75%" style="display: block; margin: auto;" /></p>
<p>An appropriate title for this figure could be:</p>
<p>“<strong>Figure X. Chemical concentration distributions of biomass burn conditions.</strong> The boxplots are based on the scaled chemical concentration values, which used the raw chemical concentrations values scaled within each chemical. The individual dots represent the concentrations of each chemical. The biomass burn conditions on the y axis are ordered from greatest (top) to least (bottom) based on median scaled chemical concentration.”</p>
<div id="answer-to-environmental-health-question-1-1" class="section level3 hasAnchor">
<h3>Answer to Environmental Health Question 1<a href="improving-data-visualizations.html#answer-to-environmental-health-question-1-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="question">
<p><em>With this, we can answer <strong>Environmental Health Question #1</strong></em>: Which biomass burn condition has the highest total chemical concentration?</p>
</div>
<div class="answer">
<p><strong>Answer</strong>: Smoldering peat has the highest median chemical concentration, however the median concentrations are comparable across all biomass burn conditions. All the flaming conditions have the highest median chemical concentrations and more overall variation than their respective smoldering conditions with the exception of smoldering peat.</p>
</div>
<p>You may notice that the scaled chemical concentration was put on the x axis and burn condition was put on the y axis and not vice versa. When names are longer in length, they are more legible if placed on the y axis.</p>
<p>Other aspects of the figure were changed in the latest version, but those are minor compared to changing the order of the boxplots, revamping the text, and changing the usage of color. For example, the background was changed from gray to white. Figure backgrounds are generally white, because the figure is easier to read if the paper is printed in black and white. A plot’s background can easily be changed to white in R using <code>theme_light()</code>, <code>theme_minimal()</code>, or <code>theme_bw()</code>. Posit provides a very helpful <a href="https://posit.co/resources/cheatsheets/?type=posit-cheatsheets&amp;_page=2/">GGplot2 cheat sheet</a> for changing a figure’s parameters.</p>
<p><br></p>
</div>
</div>
<div id="creating-an-improved-heatmap-visualization" class="section level2 hasAnchor">
<h2>Creating an Improved Heatmap Visualization<a href="improving-data-visualizations.html#creating-an-improved-heatmap-visualization" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We’ll use a heatmap to answer the second environmental health question: <strong>Which classes of chemicals show the highest concentrations across the evaluated biomass burn conditions?</strong> Let’s view the original heatmap from the previous module and find aspects of it that can be improved.</p>
<div class="sourceCode" id="cb222"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="improving-data-visualizations.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Changing the biomass condition variable back to a character from a factor</span></span>
<span id="cb222-2"><a href="improving-data-visualizations.html#cb222-2" aria-hidden="true" tabindex="-1"></a>scaled_longer_smoke_data<span class="sc">$</span>Biomass_Burn_Condition <span class="ot">=</span> <span class="fu">as.character</span>(scaled_longer_smoke_data<span class="sc">$</span>Biomass_Burn_Condition)</span>
<span id="cb222-3"><a href="improving-data-visualizations.html#cb222-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-4"><a href="improving-data-visualizations.html#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating the median value within each biomass burn condition and category</span></span>
<span id="cb222-5"><a href="improving-data-visualizations.html#cb222-5" aria-hidden="true" tabindex="-1"></a>scaled_longer_smoke_data <span class="ot">=</span> scaled_longer_smoke_data <span class="sc">%&gt;%</span></span>
<span id="cb222-6"><a href="improving-data-visualizations.html#cb222-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Biomass_Burn_Condition, Chemical.Category) <span class="sc">%&gt;%</span></span>
<span id="cb222-7"><a href="improving-data-visualizations.html#cb222-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">Median_Scaled_Concentration =</span> <span class="fu">median</span>(Scaled_Chemical_Concentration))</span>
<span id="cb222-8"><a href="improving-data-visualizations.html#cb222-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb222-9"><a href="improving-data-visualizations.html#cb222-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting</span></span>
<span id="cb222-10"><a href="improving-data-visualizations.html#cb222-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> scaled_longer_smoke_data, <span class="fu">aes</span>(<span class="at">x =</span> Chemical.Category, <span class="at">y =</span> Biomass_Burn_Condition,</span>
<span id="cb222-11"><a href="improving-data-visualizations.html#cb222-11" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">fill =</span> Median_Scaled_Concentration)) <span class="sc">+</span> </span>
<span id="cb222-12"><a href="improving-data-visualizations.html#cb222-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span> </span>
<span id="cb222-13"><a href="improving-data-visualizations.html#cb222-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Median_Scaled_Concentration, <span class="dv">2</span>))) <span class="co"># adding concentration values as text, rounding to two values after the decimal</span></span></code></pre></div>
<p><img src="03-Chapter3_files/figure-html/unnamed-chunk-31-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>From the figure above, it’s clear that certain biomass burn conditions are associated with higher chemical concentrations for some of the chemical categories. For example, peat flaming exposure was associated with higher levels of inorganics and ions, while pine smoldering exposure was associated with higher levels of methoxyphenols. Although these are important findings, it is still difficult to determine if there are greater similarities in chemical profiles based on the biomass or the incineration temperature. Therefore, let’s identify some elements of this chart that can be modified to make it easier to answer our research question.</p>
<div id="there-are-three-main-aspects-we-can-adjust-on-this-figure" class="section level3 hasAnchor txtbx">
<h3>There are three main aspects we can adjust on this figure:<a href="improving-data-visualizations.html#there-are-three-main-aspects-we-can-adjust-on-this-figure" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>1. The legibility of the text in the legend and axes.</strong>
Similar to what we did previously, we’ll replace underscores and periods with spaces in the axis labels and titles.</p>
<p><strong>2. The order of the axis labels.</strong>
Ordering the biomass burn condition and chemical category from highest to lowest based on their median scaled chemical concentration allows the reader to easily determine the biomass burn condition that had the greatest or least total chemical concentrations relative to each other. From the previous boxplot figure, biomass burn condition is already in this order, however we need to order the chemical category by putting the variable into a factor.</p>
<p><strong>3. Use of color.</strong>
Notice that in the boxplot we used a qualitative palette, which is best for creating visual differences between different classes or groups. In this heatmap, we’ll choose a diverging color palette that uses two or more contrasting colors. A diverging color palette is able to highlight mid range with a lighter color and values at either extreme with a darker color or vice versa.</p>
</div>
<p><strong>#1: Legibility of Text</strong> can be addressed in <code>ggplot()</code> and so can <strong>#2: Reordering the heatmap</strong>.</p>
<p><code>Biomass_Burn_Condition</code> has already been reordered and put into a factor, but we need to do the same with <code>Chemical.Category</code>. Similar to before, median scaled chemical concentration for each chemical category will be calculated. However, this time the new dataframe will be arranged from highest to lowest median scaled concentration from the top of the dataframe to the bottom. <code>ggplot()</code> will plot them in the SAME order with the highest concentration on the left side and the lowest on the right side of the figure.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="improving-data-visualizations.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Order the chemical category by the median scaled chemical concentration</span></span>
<span id="cb223-2"><a href="improving-data-visualizations.html#cb223-2" aria-hidden="true" tabindex="-1"></a>median_chemical <span class="ot">=</span> scaled_longer_smoke_data <span class="sc">%&gt;%</span></span>
<span id="cb223-3"><a href="improving-data-visualizations.html#cb223-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Chemical.Category) <span class="sc">%&gt;%</span></span>
<span id="cb223-4"><a href="improving-data-visualizations.html#cb223-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Median_Concentration =</span> <span class="fu">median</span>(Scaled_Chemical_Concentration)) <span class="sc">%&gt;%</span></span>
<span id="cb223-5"><a href="improving-data-visualizations.html#cb223-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(<span class="sc">-</span>Median_Concentration)</span>
<span id="cb223-6"><a href="improving-data-visualizations.html#cb223-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb223-7"><a href="improving-data-visualizations.html#cb223-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(median_chemical)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   Chemical.Category Median_Concentration
##   &lt;chr&gt;                            &lt;dbl&gt;
## 1 Inorganics                      -0.265
## 2 n-Alkanes                       -0.335
## 3 Ions                            -0.359
## 4 Levoglucosan                    -0.417
## 5 Methoxyphenols                  -0.434
## 6 PAHs                            -0.459</code></pre>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="improving-data-visualizations.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Saving that order</span></span>
<span id="cb225-2"><a href="improving-data-visualizations.html#cb225-2" aria-hidden="true" tabindex="-1"></a>median_chemical_order <span class="ot">=</span> median_chemical<span class="sc">$</span>Chemical.Category</span></code></pre></div>
<div class="sourceCode" id="cb226"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="improving-data-visualizations.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Putting into factor to organize the chemical categories</span></span>
<span id="cb226-2"><a href="improving-data-visualizations.html#cb226-2" aria-hidden="true" tabindex="-1"></a>scaled_longer_smoke_data<span class="sc">$</span>Chemical.Category <span class="ot">=</span> <span class="fu">factor</span>(scaled_longer_smoke_data<span class="sc">$</span>Chemical.Category, </span>
<span id="cb226-3"><a href="improving-data-visualizations.html#cb226-3" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">levels =</span> median_chemical_order)</span>
<span id="cb226-4"><a href="improving-data-visualizations.html#cb226-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-5"><a href="improving-data-visualizations.html#cb226-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Putting burn conditons back into a factor to organize them</span></span>
<span id="cb226-6"><a href="improving-data-visualizations.html#cb226-6" aria-hidden="true" tabindex="-1"></a>scaled_longer_smoke_data<span class="sc">$</span>Biomass_Burn_Condition <span class="ot">=</span> <span class="fu">factor</span>(scaled_longer_smoke_data<span class="sc">$</span>Biomass_Burn_Condition, </span>
<span id="cb226-7"><a href="improving-data-visualizations.html#cb226-7" aria-hidden="true" tabindex="-1"></a>                                                                <span class="at">levels =</span> median_biomass_order)</span>
<span id="cb226-8"><a href="improving-data-visualizations.html#cb226-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb226-9"><a href="improving-data-visualizations.html#cb226-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Viewing the dataframe to be plotted</span></span>
<span id="cb226-10"><a href="improving-data-visualizations.html#cb226-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(scaled_longer_smoke_data)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 8
## # Groups:   Biomass_Burn_Condition, Chemical.Category [6]
##   Chemical.Category Chemical           CASRN     Units    Biomass_Burn_Condition
##   &lt;fct&gt;             &lt;chr&gt;              &lt;chr&gt;     &lt;chr&gt;    &lt;fct&gt;                 
## 1 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Eucalyptus Smoldering 
## 2 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Eucalyptus Flaming    
## 3 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Peat Smoldering       
## 4 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Peat Flaming          
## 5 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Pine Smoldering       
## 6 n-Alkanes         2-Methylnonadecane 1560-86-7 ng_per_… Pine Flaming          
## # ℹ 3 more variables: Chemical_Concentration &lt;dbl&gt;,
## #   Scaled_Chemical_Concentration &lt;dbl[,1]&gt;, Median_Scaled_Concentration &lt;dbl&gt;</code></pre>
<p>Now that the dataframe has been finalized, we can plot the new boxplot. The final revision, <strong>#3: Making Use of Color</strong>, will be addressed with <code>ggplot()</code>. Here a palette is chosen from the <em>RColorBrewer</em> package.</p>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="improving-data-visualizations.html#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Only needed to choose 2 colors for &#39;low&#39; and &#39;high&#39; in the heatmap</span></span>
<span id="cb228-2"><a href="improving-data-visualizations.html#cb228-2" aria-hidden="true" tabindex="-1"></a><span class="co"># `n = 8` in the code to generate more colors that can be chosen from</span></span>
<span id="cb228-3"><a href="improving-data-visualizations.html#cb228-3" aria-hidden="true" tabindex="-1"></a>rcolorbrewer_colors <span class="ot">=</span> <span class="fu">brewer.pal</span>(<span class="at">n =</span> <span class="dv">8</span>, <span class="at">name =</span> <span class="st">&#39;Accent&#39;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="improving-data-visualizations.html#cb229-1" aria-hidden="true" tabindex="-1"></a>FigureX2 <span class="ot">=</span> <span class="fu">ggplot</span>(<span class="at">data =</span> scaled_longer_smoke_data, <span class="fu">aes</span>(<span class="at">x =</span> Chemical.Category, <span class="at">y =</span> Biomass_Burn_Condition,</span>
<span id="cb229-2"><a href="improving-data-visualizations.html#cb229-2" aria-hidden="true" tabindex="-1"></a>                                           <span class="at">fill =</span> Median_Scaled_Concentration)) <span class="sc">+</span> </span>
<span id="cb229-3"><a href="improving-data-visualizations.html#cb229-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="at">color =</span> <span class="st">&#39;white&#39;</span>) <span class="sc">+</span> <span class="co"># adds white space between the tiles</span></span>
<span id="cb229-4"><a href="improving-data-visualizations.html#cb229-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">round</span>(Median_Scaled_Concentration, <span class="dv">2</span>))) <span class="sc">+</span> <span class="co"># adding concentration values as text</span></span>
<span id="cb229-5"><a href="improving-data-visualizations.html#cb229-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-6"><a href="improving-data-visualizations.html#cb229-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> <span class="co"># changing the theme</span></span>
<span id="cb229-7"><a href="improving-data-visualizations.html#cb229-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>), <span class="co"># changing size of axis labels</span></span>
<span id="cb229-8"><a href="improving-data-visualizations.html#cb229-8" aria-hidden="true" tabindex="-1"></a>      <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&quot;bold&quot;</span>, <span class="at">size =</span> <span class="fu">rel</span>(<span class="fl">1.5</span>)), <span class="co"># changes axis titles</span></span>
<span id="cb229-9"><a href="improving-data-visualizations.html#cb229-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.title =</span> <span class="fu">element_text</span>(<span class="at">face =</span> <span class="st">&#39;bold&#39;</span>, <span class="at">size =</span> <span class="dv">10</span>), <span class="co"># changes legend title</span></span>
<span id="cb229-10"><a href="improving-data-visualizations.html#cb229-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">legend.text =</span> <span class="fu">element_text</span>(<span class="at">size =</span> <span class="dv">9</span>)) <span class="sc">+</span> <span class="co"># changes legend text</span></span>
<span id="cb229-11"><a href="improving-data-visualizations.html#cb229-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-12"><a href="improving-data-visualizations.html#cb229-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Chemical Category&#39;</span>, <span class="at">y =</span> <span class="st">&#39;Biomass Burn Condition&#39;</span>, </span>
<span id="cb229-13"><a href="improving-data-visualizations.html#cb229-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">fill =</span> <span class="st">&quot;Scaled Chemical</span><span class="sc">\n</span><span class="st">Concentration (pg/mL)&quot;</span>) <span class="sc">+</span> <span class="co"># changing axis labels </span></span>
<span id="cb229-14"><a href="improving-data-visualizations.html#cb229-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> rcolorbrewer_colors[<span class="dv">5</span>], <span class="at">high =</span> rcolorbrewer_colors[<span class="dv">6</span>]) <span class="co"># changing the colors</span></span>
<span id="cb229-15"><a href="improving-data-visualizations.html#cb229-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-16"><a href="improving-data-visualizations.html#cb229-16" aria-hidden="true" tabindex="-1"></a>FigureX2</span></code></pre></div>
<p><img src="03-Chapter3_files/figure-html/unnamed-chunk-35-1.png" width="960" style="display: block; margin: auto;" /></p>
<p>An appropriate title for this figure could be:</p>
<p>“<strong>Figure X. Chemical category concentrations across biomass burn conditions.</strong> Scaled chemical concentration values are based on the raw chemical concentration values scaled within each chemical. Chemical category on the x axis is ordered from highest to lowest median concentration from left to right. Biomass burn condition on the y axis is ordered from the highest to lowest median concentration from top to bottom. The values in each tile represent the median scaled chemical concentration.”</p>
<div id="answer-to-environmental-health-question-2-2" class="section level3 hasAnchor">
<h3>Answer to Environmental Health Question 2<a href="improving-data-visualizations.html#answer-to-environmental-health-question-2-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="question">
<p><em>With this, we can answer <strong>Environmental Health Question #2</strong></em>: Which classes of chemicals show the highest concentrations across the evaluated biomass burn conditions?</p>
</div>
<div class="answer">
<p><strong>Answer</strong>: Ordering the axes from highest to lowest concentration didn’t help organize the data as much as we would’ve liked given some of the variance of chemical concentrations across the chemical categories. Nevertheless, it’s still clear that peat flaming produces the highest concentration of inorganics and ions, peat smoldering with n-Alkanes, eucalyptus smoldering with Levoglucosan, pine smoldering with methoxyphenols, and pine flaming with PAHs. In addition, flaming conditions seem to have higher levels of inorganics and ions while smoldering conditions seem to have higher levels of levoglucosan and PAHs.</p>
</div>
<p>It would be helpful if there was a way to group these chemical profiles based on similarity and that’s where the <code>pheatmap()</code> function can be helpful when it can be difficult to spot those patterns using visual inspection alone. Just for fun, let’s briefly visualize a hierarchical clustering heatmap, which will be used to group both the biomass burn conditions and chemical categories based on their chemical concentrations. In this module, we’ll focus only on the <code>pheatmap()</code> visualization, but more information on hierarchical clustering can be found in <strong>Module 5.5 Unsupervised Machine Learning II: Additional Clustering Applications</strong>.</p>
<p>As we showed in the previous module, this function requires a wide dataframe which we’ll need to create. It will contain <code>Chemical.Category</code>, <code>Biomass_Burn_Condition</code> and <code>Scaled_Chemical_Concentration</code>.</p>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="improving-data-visualizations.html#cb230-1" aria-hidden="true" tabindex="-1"></a>heatmap_df2 <span class="ot">=</span> scaled_longer_smoke_data <span class="sc">%&gt;%</span></span>
<span id="cb230-2"><a href="improving-data-visualizations.html#cb230-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(Biomass_Burn_Condition, Chemical.Category) <span class="sc">%&gt;%</span></span>
<span id="cb230-3"><a href="improving-data-visualizations.html#cb230-3" aria-hidden="true" tabindex="-1"></a>    <span class="co"># using the summarize function instead of mutate function as was done previously since we only need the median values now</span></span>
<span id="cb230-4"><a href="improving-data-visualizations.html#cb230-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">Median_Scaled_Concentration =</span> <span class="fu">median</span>(Scaled_Chemical_Concentration)) <span class="sc">%&gt;%</span></span>
<span id="cb230-5"><a href="improving-data-visualizations.html#cb230-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># transforming the data to a wide format</span></span>
<span id="cb230-6"><a href="improving-data-visualizations.html#cb230-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pivot_wider</span>(<span class="at">id_cols =</span> Biomass_Burn_Condition, <span class="at">names_from =</span> <span class="st">&quot;Chemical.Category&quot;</span>, </span>
<span id="cb230-7"><a href="improving-data-visualizations.html#cb230-7" aria-hidden="true" tabindex="-1"></a>                               <span class="at">values_from =</span> <span class="st">&quot;Median_Scaled_Concentration&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb230-8"><a href="improving-data-visualizations.html#cb230-8" aria-hidden="true" tabindex="-1"></a>    <span class="co"># converting the chemical names to row names</span></span>
<span id="cb230-9"><a href="improving-data-visualizations.html#cb230-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">column_to_rownames</span>(<span class="at">var =</span> <span class="st">&quot;Biomass_Burn_Condition&quot;</span>)</span>
<span id="cb230-10"><a href="improving-data-visualizations.html#cb230-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb230-11"><a href="improving-data-visualizations.html#cb230-11" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(heatmap_df2)</span></code></pre></div>
<pre><code>##                         Inorganics  n-Alkanes       Ions Levoglucosan
## Red Oak Smoldering      -0.6236516 -0.3895328 -0.8011155    1.1042911
## Eucalyptus Smoldering   -0.6859508 -0.3465132 -0.8016019    1.7772753
## Pine Smoldering         -0.8012749 -0.3637526 -0.8016019    0.9961855
## Pine Needles Smoldering -0.8436790 -0.3076779 -0.4611222   -0.6357051
## Pine Needles Flaming     0.3640553 -0.3850613  0.8222903   -0.8570130
## Red Oak Flaming          0.4858796 -0.3016948  0.6793662   -0.8642615
##                         Methoxyphenols       PAHs
## Red Oak Smoldering          0.04674277 -0.5179641
## Eucalyptus Smoldering      -0.06449444 -0.4724635
## Pine Smoldering             2.74452541 -0.4580922
## Pine Needles Smoldering    -0.22835290 -0.3162278
## Pine Needles Flaming       -0.46331332 -0.4179505
## Red Oak Flaming            -0.51488738 -0.5318127</code></pre>
<p>Now let’s generate the same heatmap this time using the <code>pheatmap()</code> function:</p>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="improving-data-visualizations.html#cb232-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating a color palette </span></span>
<span id="cb232-2"><a href="improving-data-visualizations.html#cb232-2" aria-hidden="true" tabindex="-1"></a>blue_pink_palette <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(rcolorbrewer_colors[<span class="dv">5</span>], rcolorbrewer_colors[<span class="dv">6</span>]))</span>
<span id="cb232-3"><a href="improving-data-visualizations.html#cb232-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-4"><a href="improving-data-visualizations.html#cb232-4" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(heatmap_df2, </span>
<span id="cb232-5"><a href="improving-data-visualizations.html#cb232-5" aria-hidden="true" tabindex="-1"></a>        <span class="co"># changing the color scheme</span></span>
<span id="cb232-6"><a href="improving-data-visualizations.html#cb232-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">color =</span> <span class="fu">blue_pink_palette</span>(<span class="dv">40</span>),</span>
<span id="cb232-7"><a href="improving-data-visualizations.html#cb232-7" aria-hidden="true" tabindex="-1"></a>        <span class="co"># hierarchical clustering of the biomass burn conditions</span></span>
<span id="cb232-8"><a href="improving-data-visualizations.html#cb232-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">cluster_rows =</span> <span class="cn">TRUE</span>, </span>
<span id="cb232-9"><a href="improving-data-visualizations.html#cb232-9" aria-hidden="true" tabindex="-1"></a>        <span class="co"># creating white space between the two largest clusters</span></span>
<span id="cb232-10"><a href="improving-data-visualizations.html#cb232-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">cutree_row =</span> <span class="dv">2</span>, </span>
<span id="cb232-11"><a href="improving-data-visualizations.html#cb232-11" aria-hidden="true" tabindex="-1"></a>        <span class="co"># adding the values for each cell and making those values black</span></span>
<span id="cb232-12"><a href="improving-data-visualizations.html#cb232-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">display_numbers =</span> <span class="cn">TRUE</span>, <span class="at">number_color =</span> <span class="st">&quot;black&quot;</span>, </span>
<span id="cb232-13"><a href="improving-data-visualizations.html#cb232-13" aria-hidden="true" tabindex="-1"></a>        <span class="co"># changing the font size and the angle of the column names</span></span>
<span id="cb232-14"><a href="improving-data-visualizations.html#cb232-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">fontsize =</span> <span class="dv">12</span>, <span class="at">angle_col =</span> <span class="dv">45</span>) </span></code></pre></div>
<p><img src="03-Chapter3_files/figure-html/unnamed-chunk-37-1.png" width="672" style="display: block; margin: auto;" />
By using incorporating the dendrogram into the visualization, it’s easier to see that the chemical profiles have greater similarities within incineration temperatures rather than biomasses (with the exception of pine needles smoldering).</p>
<p><br></p>
</div>
</div>
<div id="creating-multi-plot-figures" class="section level2 hasAnchor">
<h2>Creating Multi-Plot Figures<a href="improving-data-visualizations.html#creating-multi-plot-figures" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We can combine figures using the <code>plot_grid()</code> function from the <em>cowplot</em> package. For additional information on the <code>plot_grid()</code> function and parameters that can be changed see <a href="https://wilkelab.org/cowplot/articles/plot_grid.html">Arranging Plots in a Grid</a>. Other packages that have figure combining capabilities include the <em><a href="https://patchwork.data-imaginist.com/">patchwork</a></em> package and the <a href="https://cran.r-project.org/web/packages/gridExtra/vignettes/arrangeGrob.html"><code>grid_arrange()</code></a> function from the <em>gridExtra</em> package.</p>
<p>Figures can also be combined after they’re exported from R using other applications like MS powerpoint and Adobe pdf.</p>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="improving-data-visualizations.html#cb233-1" aria-hidden="true" tabindex="-1"></a>FigureX <span class="ot">=</span> <span class="fu">plot_grid</span>(FigureX1, FigureX2,</span>
<span id="cb233-2"><a href="improving-data-visualizations.html#cb233-2" aria-hidden="true" tabindex="-1"></a>                     <span class="co"># Adding labels, changing size their size and position</span></span>
<span id="cb233-3"><a href="improving-data-visualizations.html#cb233-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="st">&quot;AUTO&quot;</span>, <span class="at">label_size =</span> <span class="dv">15</span>, <span class="at">label_x =</span> <span class="fl">0.04</span>,</span>
<span id="cb233-4"><a href="improving-data-visualizations.html#cb233-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">rel_widths =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="fl">1.5</span>))</span>
<span id="cb233-5"><a href="improving-data-visualizations.html#cb233-5" aria-hidden="true" tabindex="-1"></a>FigureX</span></code></pre></div>
<p><img src="03-Chapter3_files/figure-html/unnamed-chunk-38-1.png" width="1920" style="display: block; margin: auto;" /></p>
<p>An appropriate title for this figure could be:</p>
<p>“<strong>Figure X. Chemical concentration distributions across biomass burn conditions.</strong> (A) The boxplots are based on the scaled chemical concentration values, which used the raw chemical concentrations values scaled within each chemical. The individual dots represent the concentrations of each chemical. The biomass burn conditions on the y axis are ordered from greatest (top) to least (bottom) based on median scaled chemical concentration. (B) The heatmap visualizes concentrations across chemical categories. Chemical category on the x axis is ordered from highest to lowest median concentration from left to right. Biomass burn condition on the y axis is ordered from the highest to lowest median concentration from top to bottom. The values in each tile represent the median scaled chemical concentration.</p>
<p>By putting these two figures side by side, it’s now easier to compare the distributions of each biomass burn condition in figure A alongside the median chemical category concentrations in figure B that are responsible for the variation seen on the left.</p>
<p><br></p>
</div>
<div id="concluding-remarks-9" class="section level2 hasAnchor">
<h2>Concluding Remarks<a href="improving-data-visualizations.html#concluding-remarks-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In conclusion, this training module provided information and example code for improving, streamlining, and making <em>ggplot2</em> figures publication ready. Keep in mind that concepts and ideas presented in this module can be subjective and might need to be amended given the situation, dataset, and visualization.</p>
<p><br></p>
<div id="additional-resources-3" class="section level3 hasAnchor">
<h3>Additional Resources<a href="improving-data-visualizations.html#additional-resources-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<ul>
<li><a href="https://towardsdatascience.com/beginners-guide-to-enhancing-visualizations-in-r-9fa5a00927c9">Beginner’s Guide to Data Visualizations</a> and <a href="https://towardsdatascience.com/8-tips-for-better-data-visualization-2f7118e8a9f4">Improving Data Visualizations in R</a></li>
<li><a href="https://blog.datawrapper.de/colorguide/">Generating Colors for Visualizations</a></li>
<li><a href="https://github.com/hbctraining/publication_perfect">Additional Hands on Training</a></li>
<li>Brewer, Cynthia A. 1994. Color use guidelines for mapping and visualization. Chapter 7 (pp. 123-147) in Visualization in Modern Cartography</li>
<li>Hattab, G., Rhyne, T.-M., &amp; Heider, D. (2020). Ten simple rules to colorize biological data visualization. PLOS Computational Biology, 16(10), e1008259. PMID: <a href="https://doi.org/10.1371/journal.pcbi.1008259">33057327</a></li>
</ul>
<p>Lastly, for researchers who are newer to R programming, <a href="http://www.sthda.com/english/articles/24-ggpubr-publication-ready-plots/"><em>ggpubr</em></a> is a package specifically designed to create publication-ready graphs similar to <em>ggplot2</em> with more concise syntax. This package is particularly useful for statistically relevant visualizations, which are further explored in later modules including, <strong>TAME 2.0 Module 3.4 Introduction to Statistical Tests</strong>, <strong>TAME 2.0 Module 4.4 Two Group Comparisons and Visualizations</strong>, and <strong>TAME 2.0 Module 4.5 Multigroup Comparisons and Visualizations</strong>.</p>
<p><br></p>
<p><label class="tykfont">
Test Your Knowledge
</label></p>
<div class="tyk">
<p>Replicate the figure below! The heatmap is the same as the “Test Your Knowledge” figure from <strong>TAME 2.0 Module 3.1 Data Visualizations</strong>. This time we’ll focus on making the figure look more publication ready by cleaning up the titles, cleaning up the labels, and changing the colors. The heatmap still visualizes the median chemical concentrations, but this time we’re separating the burn conditions, allowing us to determine if the concentrations of chemicals released are contingent upon the burn condition.</p>
<p><strong>Hint</strong>: To view additional aspects of figures that can be changed in <em>ggplot2</em> check out this <a href="https://www.maths.usyd.edu.au/u/UG/SM/STAT3022/r/current/Misc/data-visualization-2.1.pdf">GGPlot2 Cheat Sheet</a>. It might come in handy!</p>
</div>
<p><img src="Module3_2_Input/Module3_2_Image4.png" width="2400" style="display: block; margin: auto;" /></p>
<!-- ############################################################################################################################# -->
<!-- ################################################## -->
<!-- ################################################## -->
<!-- START SECTION THREE  -->
<!-- ################################################## -->
<!-- ################################################## -->
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-visualizations.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="normality-tests-and-data-transformations.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf", "_main.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
